{"description":"APOSTrequesttowebapplicationreturneda403response,whichindicatesthewebapplicationdeclinedtoprocesstherequestbecausetheactionrequestedwasnotallowed","false_positives":["Securityscansandtestsmayresultintheseerrors.Misconfiguredorbuggyapplicationsmayproducelargenumbersoftheseerrors.Ifthesourceisunexpected,theuserunauthorized,ortherequestunusual,thesemayindicatesuspiciousormaliciousactivity."],"index":["apm-*-transaction*"],"language":"kuery","name":"WebApplicationSuspiciousActivity:POSTRequestDeclined","query":"http.response.status_code:403andhttp.request.method:post","references":["https://en.wikipedia.org/wiki/HTTP_403"],"risk_score":47,"rule_id":"a87a4e42-1d82-44bd-b0bf-d9b7f91fb89e","severity":"medium","tags":["APM","Elastic"],"type":"query","version":2}
{"description":"Arequesttowebapplicationreturneda405responsewhichindicatesthewebapplicationdeclinedtoprocesstherequestbecausetheHTTPmethodisnotallowedfortheresource","false_positives":["Securityscansandtestsmayresultintheseerrors.Misconfiguredorbuggyapplicationsmayproducelargenumbersoftheseerrors.Ifthesourceisunexpected,theuserunauthorized,ortherequestunusual,thesemayindicatesuspiciousormaliciousactivity."],"index":["apm-*-transaction*"],"language":"kuery","name":"WebApplicationSuspiciousActivity:UnauthorizedMethod","query":"http.response.status_code:405","references":["https://en.wikipedia.org/wiki/HTTP_405"],"risk_score":47,"rule_id":"75ee75d8-c180-481c-ba88-ee50129a6aef","severity":"medium","tags":["APM","Elastic"],"type":"query","version":2}
{"description":"ElasticEndpointdetectedanAdversaryBehavior.ClicktheElasticEndpointiconintheevent.modulecolumnorthelinkintherule.referencecolumnintheExternalAlertstaboftheSIEMDetectionspageforadditionalinformation.","from":"now-15m","index":["endgame-*"],"interval":"10m","language":"kuery","name":"AdversaryBehavior-Detected-ElasticEndpoint","query":"event.kind:alertandevent.module:endgameand(event.action:rules_engine_eventorendgame.event_subtype_full:rules_engine_event)","risk_score":47,"rule_id":"77a3c3df-8ec4-4da4-b758-878f551dee69","severity":"medium","tags":["Elastic","Endpoint"],"type":"query","version":2}
{"description":"ElasticEndpointdetectedCredentialDumping.ClicktheElasticEndpointiconintheevent.modulecolumnorthelinkintherule.referencecolumnintheExternalAlertstaboftheSIEMDetectionspageforadditionalinformation.","from":"now-15m","index":["endgame-*"],"interval":"10m","language":"kuery","name":"CredentialDumping-Detected-ElasticEndpoint","query":"event.kind:alertandevent.module:endgameandendgame.metadata.type:detectionand(event.action:cred_theft_eventorendgame.event_subtype_full:cred_theft_event)","risk_score":73,"rule_id":"571afc56-5ed9-465d-a2a9-045f099f6e7e","severity":"high","tags":["Elastic","Endpoint"],"type":"query","version":2}
{"description":"ElasticEndpointpreventedCredentialDumping.ClicktheElasticEndpointiconintheevent.modulecolumnorthelinkintherule.referencecolumnintheExternalAlertstaboftheSIEMDetectionspageforadditionalinformation.","from":"now-15m","index":["endgame-*"],"interval":"10m","language":"kuery","name":"CredentialDumping-Prevented-ElasticEndpoint","query":"event.kind:alertandevent.module:endgameandendgame.metadata.type:preventionand(event.action:cred_theft_eventorendgame.event_subtype_full:cred_theft_event)","risk_score":47,"rule_id":"db8c33a8-03cd-4988-9e2c-d0a4863adb13","severity":"medium","tags":["Elastic","Endpoint"],"type":"query","version":2}
{"description":"ElasticEndpointdetectedCredentialManipulation.ClicktheElasticEndpointiconintheevent.modulecolumnorthelinkintherule.referencecolumnintheExternalAlertstaboftheSIEMDetectionspageforadditionalinformation.","from":"now-15m","index":["endgame-*"],"interval":"10m","language":"kuery","name":"CredentialManipulation-Detected-ElasticEndpoint","query":"event.kind:alertandevent.module:endgameandendgame.metadata.type:detectionand(event.action:token_manipulation_eventorendgame.event_subtype_full:token_manipulation_event)","risk_score":73,"rule_id":"c0be5f31-e180-48ed-aa08-96b36899d48f","severity":"high","tags":["Elastic","Endpoint"],"type":"query","version":2}
{"description":"ElasticEndpointpreventedCredentialManipulation.ClicktheElasticEndpointiconintheevent.modulecolumnorthelinkintherule.referencecolumnintheExternalAlertstaboftheSIEMDetectionspageforadditionalinformation.","from":"now-15m","index":["endgame-*"],"interval":"10m","language":"kuery","name":"CredentialManipulation-Prevented-ElasticEndpoint","query":"event.kind:alertandevent.module:endgameandendgame.metadata.type:preventionand(event.action:token_manipulation_eventorendgame.event_subtype_full:token_manipulation_event)","risk_score":47,"rule_id":"c9e38e64-3f4c-4bf3-ad48-0e61a60ea1fa","severity":"medium","tags":["Elastic","Endpoint"],"type":"query","version":2}
{"description":"ElasticEndpointdetectedanExploit.ClicktheElasticEndpointiconintheevent.modulecolumnorthelinkintherule.referencecolumnintheExternalAlertstaboftheSIEMDetectionspageforadditionalinformation.","from":"now-15m","index":["endgame-*"],"interval":"10m","language":"kuery","name":"Exploit-Detected-ElasticEndpoint","query":"event.kind:alertandevent.module:endgameandendgame.metadata.type:detectionand(event.action:exploit_eventorendgame.event_subtype_full:exploit_event)","risk_score":73,"rule_id":"2003cdc8-8d83-4aa5-b132-1f9a8eb48514","severity":"high","tags":["Elastic","Endpoint"],"type":"query","version":2}
{"description":"ElasticEndpointpreventedanExploit.ClicktheElasticEndpointiconintheevent.modulecolumnorthelinkintherule.referencecolumnintheExternalAlertstaboftheSIEMDetectionspageforadditionalinformation.","from":"now-15m","index":["endgame-*"],"interval":"10m","language":"kuery","name":"Exploit-Prevented-ElasticEndpoint","query":"event.kind:alertandevent.module:endgameandendgame.metadata.type:preventionand(event.action:exploit_eventorendgame.event_subtype_full:exploit_event)","risk_score":47,"rule_id":"2863ffeb-bf77-44dd-b7a5-93ef94b72036","severity":"medium","tags":["Elastic","Endpoint"],"type":"query","version":2}
{"description":"ElasticEndpointdetectedMalware.ClicktheElasticEndpointiconintheevent.modulecolumnorthelinkintherule.referencecolumnintheExternalAlertstaboftheSIEMDetectionspageforadditionalinformation.","from":"now-15m","index":["endgame-*"],"interval":"10m","language":"kuery","name":"Malware-Detected-ElasticEndpoint","query":"event.kind:alertandevent.module:endgameandendgame.metadata.type:detectionand(event.action:file_classification_eventorendgame.event_subtype_full:file_classification_event)","risk_score":99,"rule_id":"0a97b20f-4144-49ea-be32-b540ecc445de","severity":"critical","tags":["Elastic","Endpoint"],"type":"query","version":2}
{"description":"ElasticEndpointpreventedMalware.ClicktheElasticEndpointiconintheevent.modulecolumnorthelinkintherule.referencecolumnintheExternalAlertstaboftheSIEMDetectionspageforadditionalinformation.","from":"now-15m","index":["endgame-*"],"interval":"10m","language":"kuery","name":"Malware-Prevented-ElasticEndpoint","query":"event.kind:alertandevent.module:endgameandendgame.metadata.type:preventionand(event.action:file_classification_eventorendgame.event_subtype_full:file_classification_event)","risk_score":73,"rule_id":"3b382770-efbb-44f4-beed-f5e0a051b895","severity":"high","tags":["Elastic","Endpoint"],"type":"query","version":2}
{"description":"ElasticEndpointdetectedPermissionTheft.ClicktheElasticEndpointiconintheevent.modulecolumnorthelinkintherule.referencecolumnintheExternalAlertstaboftheSIEMDetectionspageforadditionalinformation.","from":"now-15m","index":["endgame-*"],"interval":"10m","language":"kuery","name":"PermissionTheft-Detected-ElasticEndpoint","query":"event.kind:alertandevent.module:endgameandendgame.metadata.type:detectionand(event.action:token_protection_eventorendgame.event_subtype_full:token_protection_event)","risk_score":73,"rule_id":"c3167e1b-f73c-41be-b60b-87f4df707fe3","severity":"high","tags":["Elastic","Endpoint"],"type":"query","version":2}
{"description":"ElasticEndpointpreventedPermissionTheft.ClicktheElasticEndpointiconintheevent.modulecolumnorthelinkintherule.referencecolumnintheExternalAlertstaboftheSIEMDetectionspageforadditionalinformation.","from":"now-15m","index":["endgame-*"],"interval":"10m","language":"kuery","name":"PermissionTheft-Prevented-ElasticEndpoint","query":"event.kind:alertandevent.module:endgameandendgame.metadata.type:preventionand(event.action:token_protection_eventorendgame.event_subtype_full:token_protection_event)","risk_score":47,"rule_id":"453f659e-0429-40b1-bfdb-b6957286e04b","severity":"medium","tags":["Elastic","Endpoint"],"type":"query","version":2}
{"description":"ElasticEndpointdetectedProcessInjection.ClicktheElasticEndpointiconintheevent.modulecolumnorthelinkintherule.referencecolumnintheExternalAlertstaboftheSIEMDetectionspageforadditionalinformation.","from":"now-15m","index":["endgame-*"],"interval":"10m","language":"kuery","name":"ProcessInjection-Detected-ElasticEndpoint","query":"event.kind:alertandevent.module:endgameandendgame.metadata.type:detectionand(event.action:kernel_shellcode_eventorendgame.event_subtype_full:kernel_shellcode_event)","risk_score":73,"rule_id":"80c52164-c82a-402c-9964-852533d58be1","severity":"high","tags":["Elastic","Endpoint"],"type":"query","version":2}
{"description":"ElasticEndpointpreventedProcessInjection.ClicktheElasticEndpointiconintheevent.modulecolumnorthelinkintherule.referencecolumnintheExternalAlertstaboftheSIEMDetectionspageforadditionalinformation.","from":"now-15m","index":["endgame-*"],"interval":"10m","language":"kuery","name":"ProcessInjection-Prevented-ElasticEndpoint","query":"event.kind:alertandevent.module:endgameandendgame.metadata.type:preventionand(event.action:kernel_shellcode_eventorendgame.event_subtype_full:kernel_shellcode_event)","risk_score":47,"rule_id":"990838aa-a953-4f3e-b3cb-6ddf7584de9e","severity":"medium","tags":["Elastic","Endpoint"],"type":"query","version":2}
{"description":"ElasticEndpointdetectedRansomware.ClicktheElasticEndpointiconintheevent.modulecolumnorthelinkintherule.referencecolumnintheExternalAlertstaboftheSIEMDetectionspageforadditionalinformation.","from":"now-15m","index":["endgame-*"],"interval":"10m","language":"kuery","name":"Ransomware-Detected-ElasticEndpoint","query":"event.kind:alertandevent.module:endgameandendgame.metadata.type:detectionand(event.action:ransomware_eventorendgame.event_subtype_full:ransomware_event)","risk_score":99,"rule_id":"8cb4f625-7743-4dfb-ae1b-ad92be9df7bd","severity":"critical","tags":["Elastic","Endpoint"],"type":"query","version":2}
{"description":"ElasticEndpointpreventedRansomware.ClicktheElasticEndpointiconintheevent.modulecolumnorthelinkintherule.referencecolumnintheExternalAlertstaboftheSIEMDetectionspageforadditionalinformation.","from":"now-15m","index":["endgame-*"],"interval":"10m","language":"kuery","name":"Ransomware-Prevented-ElasticEndpoint","query":"event.kind:alertandevent.module:endgameandendgame.metadata.type:preventionand(event.action:ransomware_eventorendgame.event_subtype_full:ransomware_event)","risk_score":73,"rule_id":"e3c5d5cb-41d5-4206-805c-f30561eae3ac","severity":"high","tags":["Elastic","Endpoint"],"type":"query","version":2}
{"description":"Adversariescanaddthe'hidden'attributetofilestohidethemfromtheuserinanattempttoevadedetection.","index":["winlogbeat-*"],"language":"kuery","name":"AddingHiddenFileAttributeviaAttrib","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.name:attrib.exeandprocess.args:+h","risk_score":21,"rule_id":"4630d948-40d4-4cef-ac69-4002e29bc3db","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1158","name":"HiddenFilesandDirectories","reference":"https://attack.mitre.org/techniques/T1158/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1158","name":"HiddenFilesandDirectories","reference":"https://attack.mitre.org/techniques/T1158/"}]}],"type":"query","version":2}
{"description":"DetectswritingexecutablefilesthatwillbeautomaticallylaunchedbyAdobeonlaunch.","index":["winlogbeat-*"],"language":"kuery","name":"AdobeHijackPersistence","query":"file.path:(\"C:\\ProgramFiles(x86)\\Adobe\\AcrobatReaderDC\\Reader\\AcroCEF\\RdrCEF.exe\"or\"C:\\ProgramFiles\\Adobe\\AcrobatReaderDC\\Reader\\AcroCEF\\RdrCEF.exe\")andevent.action:\"Filecreated(rule:FileCreate)\"andnotprocess.name:msiexec.exe","risk_score":21,"rule_id":"2bf78aa2-9c56-48de-b139-f169bf99cf86","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1044","name":"FileSystemPermissionsWeakness","reference":"https://attack.mitre.org/techniques/T1044/"}]}],"type":"query","version":2}
{"description":"IdentifiesattemptstoclearWindowseventlogstores.Thisisoftendonebyattackersinanattempttoevadedetectionordestroyforensicevidenceonasystem.","index":["winlogbeat-*"],"language":"kuery","name":"ClearingWindowsEventLogs","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.name:wevtutil.exeandprocess.args:clorprocess.name:powershell.exeandprocess.args:Clear-EventLog","risk_score":21,"rule_id":"d331bbe2-6db4-4941-80a5-8270db72eb61","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1070","name":"IndicatorRemovalonHost","reference":"https://attack.mitre.org/techniques/T1070/"}]}],"type":"query","version":2}
{"description":"Identifiesuseofthefsutil.exetodeletethevolumeUSNJRNL.Thistechniqueisusedbyattackerstoeliminateevidenceoffilescreatedduringpost-exploitationactivities.","index":["winlogbeat-*"],"language":"kuery","name":"DeleteVolumeUSNJournalwithFsutil","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.name:fsutil.exeandprocess.args:(deletejournalandusn)","risk_score":21,"rule_id":"f675872f-6d85-40a3-b502-c0d2ef101e92","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1107","name":"FileDeletion","reference":"https://attack.mitre.org/techniques/T1107/"}]}],"type":"query","version":2}
{"description":"Identifiesuseofthewbadmin.exetodeletethebackupcatalog.Ransomwareandothermalwaremaydothistopreventsystemrecovery.","index":["winlogbeat-*"],"language":"kuery","name":"DeletingBackupCatalogswithWbadmin","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.name:wbadmin.exeandprocess.args:(cataloganddelete)","risk_score":21,"rule_id":"581add16-df76-42bb-af8e-c979bfb39a59","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1107","name":"FileDeletion","reference":"https://attack.mitre.org/techniques/T1107/"}]}],"type":"query","version":2}
{"description":"Identifiesunexpectedprocessesmakingnetworkconnectionsoverport445.WindowsFileSharingistypicallyimplementedoverServerMessageBlock(SMB),whichcommunicatesbetweenhostsusingport445.Whenlegitimate,thesenetworkconnectionsareestablishedbythekernel.Processesmaking445/tcpconnectionsmaybeportscanners,exploits,orsuspicioususer-levelprocessesmovinglaterally.","index":["winlogbeat-*"],"language":"kuery","name":"DirectOutboundSMBConnection","query":"event.action:\"Networkconnectiondetected(rule:NetworkConnect)\"anddestination.port:445andnotprocess.pid:4andnotdestination.ip:(127.0.0.1or\"::1\")","risk_score":47,"rule_id":"c82c7d8f-fb9e-4874-a4bd-fd9e3f9becf1","severity":"medium","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0008","name":"LateralMovement","reference":"https://attack.mitre.org/tactics/TA0008/"},"technique":[{"id":"T1210","name":"ExploitationofRemoteServices","reference":"https://attack.mitre.org/techniques/T1210/"}]}],"type":"query","version":2}
{"description":"Identifiesuseofthenetsh.exetodisableorweakenthelocalfirewall.Attackerswillusethiscommandlinetooltodisablethefirewallduringtroubleshootingortoenablenetworkmobility.","index":["winlogbeat-*"],"language":"kuery","name":"DisableWindowsFirewallRulesviaNetsh","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.name:netsh.exeandprocess.args:(disableandfirewallandset)orprocess.args:(advfirewallandoffandstate)","risk_score":47,"rule_id":"4b438734-3793-4fda-bd42-ceeada0be8f9","severity":"medium","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1089","name":"DisablingSecurityTools","reference":"https://attack.mitre.org/techniques/T1089/"}]}],"type":"query","version":2}
{"description":"Identifiestheuseofcertutil.exetoencodeordecodedata.CertUtilisanativeWindowscomponentwhichispartofCertificateServices.CertUtilisoftenabusedbyattackerstoencodeordecodebase64dataforstealthiercommandandcontrolorexfiltration.","index":["winlogbeat-*"],"language":"kuery","name":"EncodingorDecodingFilesviaCertUtil","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.name:certutil.exeandprocess.args:(-decodeor-encodeor/decodeor/encode)","risk_score":47,"rule_id":"fd70c98a-c410-42dc-a2e3-761c71848acf","severity":"medium","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1140","name":"Deobfuscate/DecodeFilesorInformation","reference":"https://attack.mitre.org/techniques/T1140/"}]}],"type":"query","version":2}
{"description":"Ascheduledtaskcanbeusedbyanadversarytoestablishpersistence,movelaterally,and/orescalateprivileges.","false_positives":["Legitimatescheduledtasksmaybecreatedduringinstallationofnewsoftware."],"index":["winlogbeat-*"],"language":"kuery","name":"LocalScheduledTaskCommands","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.name:schtasks.exeandprocess.args:(-changeor-createor-runor-sor/Sor/changeor/createor/run)","risk_score":21,"rule_id":"afcce5ad-65de-4ed2-8516-5e093d3ac99a","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1053","name":"ScheduledTask","reference":"https://attack.mitre.org/techniques/T1053/"}]}],"type":"query","version":2}
{"description":"Identifiesuseofsc.exetocreate,modify,orstartservicesonremotehosts.Thiscouldbeindicativeofadversarylateralmovementbutwillbenoisyifcommonlydonebyadmins.","index":["winlogbeat-*"],"language":"kuery","name":"LocalServiceCommands","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.name:sc.exeandprocess.args:(configorcreateorfailureorstart)","risk_score":21,"rule_id":"e8571d5f-bea1-46c2-9f56-998de2d3ed95","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1021","name":"RemoteServices","reference":"https://attack.mitre.org/techniques/T1021/"}]}],"type":"query","version":2}
{"description":"IdentifiesMsBuild.exemakingoutboundnetworkconnections.ThismayindicateadversarialactivityasMsBuildisoftenleveragedbyadversariestoexecutecodeandevadedetection.","index":["winlogbeat-*"],"language":"kuery","name":"MsBuildMakingNetworkConnections","query":"event.action:\"Networkconnectiondetected(rule:NetworkConnect)\"andprocess.name:MSBuild.exeandnotdestination.ip:(127.0.0.1or\"::1\")","risk_score":47,"rule_id":"0e79980b-4250-4a50-a509-69294c14e84b","severity":"medium","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1127","name":"TrustedDeveloperUtilities","reference":"https://attack.mitre.org/techniques/T1127/"}]}],"type":"query","version":2}
{"description":"Identifiesmshta.exemakinganetworkconnection.Thismayindicateadversarialactivityasmshta.exeisoftenleveragedbyadversariestoexecutemaliciousscriptsandevadedetection.","index":["winlogbeat-*"],"language":"kuery","name":"NetworkConnectionviaMshta","query":"event.action:\"Networkconnectiondetected(rule:NetworkConnect)\"andprocess.name:mshta.exe","references":["https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html"],"risk_score":47,"rule_id":"a4ec1382-4557-452b-89ba-e413b22ed4b8","severity":"medium","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1170","name":"Mshta","reference":"https://attack.mitre.org/techniques/T1170/"}]}],"type":"query","version":2}
{"description":"IdentifiesuseoftheSysInternalstoolPsExec.exemakinganetworkconnection.Thiscouldbeanindicationoflateralmovement.","false_positives":["PsExecisadual-usetoolthatcanbeusedforbenignormaliciousactivity.It'simportanttobaselineyourenvironmenttodeterminetheamountofnoisetoexpectfromthistool."],"index":["winlogbeat-*"],"language":"kuery","name":"PsExecNetworkConnection","query":"process.name:PsExec.exeandevent.action:\"Networkconnectiondetected(rule:NetworkConnect)\"","risk_score":21,"rule_id":"55d551c6-333b-4665-ab7e-5d14a59715ce","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1035","name":"ServiceExecution","reference":"https://attack.mitre.org/techniques/T1035/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0008","name":"LateralMovement","reference":"https://attack.mitre.org/tactics/TA0008/"},"technique":[{"id":"T1035","name":"ServiceExecution","reference":"https://attack.mitre.org/techniques/T1035/"}]}],"type":"query","version":2}
{"description":"IdentifiessuspiciouschildprocessesoffrequentlytargetedMicrosoftOfficeapplications(Word,PowerPoint,Excel).ThesechildprocessesareoftenlaunchedduringexploitationofOfficeapplicationsorfromdocumentswithmaliciousmacros.","index":["winlogbeat-*"],"language":"kuery","name":"SuspiciousMSOfficeChildProcess","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.parent.name:(eqnedt32.exeorexcel.exeorfltldr.exeormsaccess.exeormspub.exeorpowerpnt.exeorwinword.exe)andprocess.name:(Microsoft.Workflow.Compiler.exeorarp.exeoratbroker.exeorbginfo.exeorbitsadmin.exeorcdb.exeorcertutil.exeorcmd.exeorcmstp.exeorcscript.exeorcsi.exeordnx.exeordsget.exeordsquery.exeorforfiles.exeorfsi.exeorftp.exeorgpresult.exeorhostname.exeorieexec.exeoriexpress.exeorinstallutil.exeoripconfig.exeormshta.exeormsxsl.exeornbtstat.exeornet.exeornet1.exeornetsh.exeornetstat.exeornltest.exeorodbcconf.exeorping.exeorpowershell.exeorpwsh.exeorqprocess.exeorquser.exeorqwinsta.exeorrcsi.exeorreg.exeorregasm.exeorregsvcs.exeorregsvr32.exeorsc.exeorschtasks.exeorsysteminfo.exeortasklist.exeortracert.exeorwhoami.exeorwmic.exeorwscript.exeorxwizard.exe)","risk_score":21,"rule_id":"a624863f-a70d-417f-a7d2-7a404638d47f","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1193","name":"SpearphishingAttachment","reference":"https://attack.mitre.org/techniques/T1193/"}]}],"type":"query","version":2}
{"description":"IdentifiessuspiciouschildprocessesofMicrosoftOutlook.Thesechildprocessesareoftenassociatedwithspearphishingactivity.","index":["winlogbeat-*"],"language":"kuery","name":"SuspiciousMSOutlookChildProcess","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.parent.name:outlook.exeandprocess.name:(Microsoft.Workflow.Compiler.exeorarp.exeoratbroker.exeorbginfo.exeorbitsadmin.exeorcdb.exeorcertutil.exeorcmd.exeorcmstp.exeorcscript.exeorcsi.exeordnx.exeordsget.exeordsquery.exeorforfiles.exeorfsi.exeorftp.exeorgpresult.exeorhostname.exeorieexec.exeoriexpress.exeorinstallutil.exeoripconfig.exeormshta.exeormsxsl.exeornbtstat.exeornet.exeornet1.exeornetsh.exeornetstat.exeornltest.exeorodbcconf.exeorping.exeorpowershell.exeorpwsh.exeorqprocess.exeorquser.exeorqwinsta.exeorrcsi.exeorreg.exeorregasm.exeorregsvcs.exeorregsvr32.exeorsc.exeorschtasks.exeorsysteminfo.exeortasklist.exeortracert.exeorwhoami.exeorwmic.exeorwscript.exeorxwizard.exe)","risk_score":21,"rule_id":"32f4675e-6c49-4ace-80f9-97c9259dca2e","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1193","name":"SpearphishingAttachment","reference":"https://attack.mitre.org/techniques/T1193/"}]}],"type":"query","version":2}
{"description":"WindowsservicestypicallyrunasSYSTEMandcanbeusedasaprivilegeescalationopportunity.MalwareorpenetrationtestersmayrunashellasaservicetogainSYSTEMpermissions.","index":["winlogbeat-*"],"language":"kuery","name":"SystemShellsviaServices","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.parent.name:services.exeandprocess.name:(cmd.exeorpowershell.exe)","risk_score":47,"rule_id":"0022d47d-39c7-4f69-a232-4fe9dc7a3acd","severity":"medium","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1050","name":"NewService","reference":"https://attack.mitre.org/techniques/T1050/"}]}],"type":"query","version":2}
{"description":"Identifiesunusualinstancesofrundll32.exemakingoutboundnetworkconnections.ThismayindicateadversarialactivityandmayidentifymaliciousDLLs.","index":["winlogbeat-*"],"language":"kuery","name":"UnusualNetworkConnectionviaRunDLL32","query":"process.name:rundll32.exeandevent.action:\"Networkconnectiondetected(rule:NetworkConnect)\"andnotdestination.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16or127.0.0.0/8)","risk_score":21,"rule_id":"52aaab7b-b51c-441a-89ce-4387b3aea886","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1085","name":"Rundll32","reference":"https://attack.mitre.org/techniques/T1085/"}]}],"type":"query","version":3}
{"description":"IdentifiesWindowsprogramsrunfromunexpectedparentprocesses.Thiscouldindicatemasqueradingorotherstrangeactivityonasystem.","index":["winlogbeat-*"],"language":"kuery","name":"UnusualParent-ChildRelationship","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.parent.executable:*and(process.name:smss.exeandnotprocess.parent.name:(Systemorsmss.exe)orprocess.name:csrss.exeandnotprocess.parent.name:(smss.exeorsvchost.exe)orprocess.name:wininit.exeandnotprocess.parent.name:smss.exeorprocess.name:winlogon.exeandnotprocess.parent.name:smss.exeorprocess.name:lsass.exeandnotprocess.parent.name:wininit.exeorprocess.name:LogonUI.exeandnotprocess.parent.name:(wininit.exeorwinlogon.exe)orprocess.name:services.exeandnotprocess.parent.name:wininit.exeorprocess.name:svchost.exeandnotprocess.parent.name:(MsMpEng.exeorservices.exe)orprocess.name:spoolsv.exeandnotprocess.parent.name:services.exeorprocess.name:taskhost.exeandnotprocess.parent.name:(services.exeorsvchost.exe)orprocess.name:taskhostw.exeandnotprocess.parent.name:(services.exeorsvchost.exe)orprocess.name:userinit.exeandnotprocess.parent.name:(dwm.exeorwinlogon.exe))","risk_score":47,"rule_id":"35df0dd8-092d-4a83-88c1-5151a804f31b","severity":"medium","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0004","name":"PrivilegeEscalation","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1093","name":"ProcessHollowing","reference":"https://attack.mitre.org/techniques/T1093/"}]}],"type":"query","version":2}
{"description":"Identifiesnetworkactivityfromunexpectedsystemapplications.Thismayindicateadversarialactivityastheseapplicationsareoftenleveragedbyadversariestoexecutecodeandevadedetection.","index":["winlogbeat-*"],"language":"kuery","name":"UnusualProcessNetworkConnection","query":"event.action:\"Networkconnectiondetected(rule:NetworkConnect)\"andprocess.name:(Microsoft.Workflow.Compiler.exeorbginfo.exeorcdb.exeorcmstp.exeorcsi.exeordnx.exeorfsi.exeorieexec.exeoriexpress.exeorodbcconf.exeorrcsi.exeorxwizard.exe)","risk_score":21,"rule_id":"610949a1-312f-4e04-bb55-3a79b8c95267","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1127","name":"TrustedDeveloperUtilities","reference":"https://attack.mitre.org/techniques/T1127/"}]}],"type":"query","version":2}
{"description":"Identifiesattemptstocreatenewlocalusers.Thisissometimesdonebyattackerstoincreaseaccesstoasystemordomain.","index":["winlogbeat-*"],"language":"kuery","name":"UserAccountCreation","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.name:(net.exeornet1.exe)andnotprocess.parent.name:net.exeandprocess.args:(userand(/ador/add))","risk_score":21,"rule_id":"1aa9181a-492b-4c01-8b16-fa0735786b2b","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1136","name":"CreateAccount","reference":"https://attack.mitre.org/techniques/T1136/"}]}],"type":"query","version":2}
{"description":"Identifiesuseofvssadmin.exeforshadowcopydeletiononendpoints.Thiscommonlyoccursintandemwithransomwareorotherdestructiveattacks.","index":["winlogbeat-*"],"language":"kuery","name":"VolumeShadowCopyDeletionviaVssAdmin","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.name:vssadmin.exeandprocess.args:(deleteandshadows)","risk_score":73,"rule_id":"b5ea4bfe-a1b2-421f-9d47-22a75a6f2921","severity":"high","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1490","name":"InhibitSystemRecovery","reference":"https://attack.mitre.org/techniques/T1490/"}]}],"type":"query","version":2}
{"description":"Identifiesuseofwmic.exeforshadowcopydeletiononendpoints.Thiscommonlyoccursintandemwithransomwareorotherdestructiveattacks.","index":["winlogbeat-*"],"language":"kuery","name":"VolumeShadowCopyDeletionviaWMIC","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.name:WMIC.exeandprocess.args:(deleteandshadowcopy)","risk_score":73,"rule_id":"dc9c1f74-dac3-48e3-b47f-eb79db358f57","severity":"high","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1107","name":"FileDeletion","reference":"https://attack.mitre.org/techniques/T1107/"}]}],"type":"query","version":2}
{"description":"IdentifiesaPowerShellprocesslaunchedbyeithercscript.exeorwscript.exe.ObservingWindowsscriptingprocessesexecutingaPowerShellscript,maybeindicativeofmaliciousactivity.","index":["winlogbeat-*"],"language":"kuery","name":"WindowsScriptExecutingPowerShell","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.parent.name:(cscript.exeorwscript.exe)andprocess.name:powershell.exe","risk_score":21,"rule_id":"f545ff26-3c94-4fd0-bd33-3c7f95a3a0fc","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1193","name":"SpearphishingAttachment","reference":"https://attack.mitre.org/techniques/T1193/"}]}],"type":"query","version":2}
{"anomaly_threshold":50,"description":"IdentifiesLinuxprocessesthatdonotusuallyusethenetworkbuthaveunexpectednetworkactivity,whichcanindicatecommand-and-control,lateralmovement,persistence,ordataexfiltrationactivity.Aprocesswithunusualnetworkactivitycandenoteprocessexploitationorinjection,wheretheprocessisusedtorunpersistencemechanismsthatallowamaliciousactorremoteaccessorcontrolofthehost,dataexfiltration,andexecutionofunauthorizednetworkapplications.","false_positives":["Anewlyinstalledprogramoronethatrarelyusesthenetworkcouldtriggerthissignal."],"from":"now-45m","interval":"15m","machine_learning_job_id":"linux_anomalous_network_activity_ecs","name":"UnusualLinuxNetworkActivity","note":"###InvestigatingUnusualNetworkActivity###\nSignalsfromthisruleindicatethepresenceofnetworkactivityfromaLinuxprocessforwhichnetworkactivityisrareandunusual.Herearesomepossibleavenuesofinvestigation:\n-ConsidertheIPaddressesandports.Aretheseusedbynormalbutinfrequentnetworkworkflows?Aretheyexpectedorunexpected?\n-IfthedestinationIPaddressisremoteorexternal,doesitassociatewithanexpecteddomain,organizationorgeography?Note:avoidinteractingdirectlywithsuspectedmaliciousIPaddresses.\n-Considertheuserasidentifiedbytheusernamefield.Isthisnetworkactivitypartofanexpectedworkflowfortheuserwhorantheprogram?\n-Examinethehistoryofexecution.Ifthisprocessmanifestedonlyveryrecently,itmightbepartofanewsoftwarepackage.Ifithasaconsistentcadence-forexampleifitrunsmonthlyorquarterly-itmightbepartofamonthlyorquarterlybusinessormaintenanceprocess.\n-Examinetheprocessarguments,titleandworkingdirectory.Thesemayprovideindicationsastothesourceoftheprogramorthenatureofthetasksitisperforming.","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"52afbdc5-db15-485e-bc24-f5707f820c4b","severity":"low","tags":["Elastic","Linux","ML"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"Identifiesunusualdestinationportactivitythatcanindicatecommand-and-control,persistencemechanism,ordataexfiltrationactivity.RarelyuseddestinationportactivityisgenerallyunusualinLinuxfleets,andcanindicateunauthorizedaccessorthreatactoractivity.","false_positives":["Anewlyinstalledprogramoronethatrarelyusesthenetworkcouldtriggerthissignal."],"from":"now-45m","interval":"15m","machine_learning_job_id":"linux_anomalous_network_port_activity_ecs","name":"UnusualLinuxNetworkPortActivity","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"3c7e32e6-6104-46d9-a06e-da0f8b5795a0","severity":"low","tags":["Elastic","Linux","ML"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"IdentifiesunusuallisteningportsonLinuxinstancesthatcanindicateexecutionofunauthorizedservices,backdoors,orpersistencemechanisms.","false_positives":["Anewlyinstalledprogramoronethatrarelyusesthenetworkcouldtriggerthissignal."],"from":"now-45m","interval":"15m","machine_learning_job_id":"linux_anomalous_network_service","name":"UnusualLinuxNetworkService","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"52afbdc5-db15-596e-bc35-f5707f820c4b","severity":"low","tags":["Elastic","Linux","ML"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"AmachinelearningjobdetectedanunusualwebURLrequestfromaLinuxhost,whichcanindicatemalwaredeliveryandexecution.WgetandcURLarecommonlyusedbyLinuxprogramstodownloadcodeanddata.Mostofthetime,theirusageisentirelynormal.Generally,becausetheyusealistofURLs,theyrepeatedlydownloadfromthesamelocations.However,WgetandcURLaresometimesusedtodeliverLinuxexploitpayloads,andthreatactorsusethesetoolstodownloadadditionalsoftwareandcode.Forthesereasons,unusualURLscanindicateunauthorizeddownloadsorthreatactivity.","false_positives":["Anewandunusualprogramorartifactdownloadinthecourseofsoftwareupgrades,debugging,ortroubleshootingcouldtriggerthissignal."],"from":"now-45m","interval":"15m","machine_learning_job_id":"linux_anomalous_network_url_activity_ecs","name":"UnusualLinuxWebActivity","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"52afbdc5-db15-485e-bc35-f5707f820c4c","severity":"low","tags":["Elastic","Linux","ML"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"SearchesforrareprocessesrunningonmultipleLinuxhostsinanentirefleetornetwork.Thisreducesthedetectionoffalsepositivessinceautomatedmaintenanceprocessesusuallyonlyrunoccasionallyonasinglemachinebutarecommontoallormanyhostsinafleet.","false_positives":["Anewlyinstalledprogramoronethatrunsrarelyaspartofamonthlyorquarterlyworkflowcouldtriggerthissignal."],"from":"now-45m","interval":"15m","machine_learning_job_id":"linux_anomalous_process_all_hosts_ecs","name":"AnomalousProcessForaLinuxPopulation","note":"###InvestigatinganUnusualLinuxProcess###\nSignalsfromthisruleindicatethepresenceofaLinuxprocessthatisrareandunusualforallofthemonitoredLinuxhostsforwhichAuditbeatdataisavailable.Herearesomepossibleavenuesofinvestigation:\n-Considertheuserasidentifiedbytheusernamefield.Isthisprogrampartofanexpectedworkflowfortheuserwhoranthisprogramonthishost?\n-Examinethehistoryofexecution.Ifthisprocessmanifestedonlyveryrecently,itmightbepartofanewsoftwarepackage.Ifithasaconsistentcadence-forexampleifitrunsmonthlyorquarterly-itmightbepartofamonthlyorquarterlybusinessprocess.\n-Examinetheprocessarguments,titleandworkingdirectory.Thesemayprovideindicationsastothesourceoftheprogramorthenatureofthetasksitisperforming.","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"647fc812-7996-4795-8869-9c4ea595fe88","severity":"low","tags":["Elastic","Linux","ML"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"Amachinelearningjobdetectedactivityforausernamethatisnotnormallyactive,whichcanindicateunauthorizedchanges,activitybyunauthorizedusers,lateralmovement,orcompromisedcredentials.Inmanyorganizations,newusernamesarenotoftencreatedapartfromspecifictypesofsystemactivities,suchascreatingnewaccountsfornewemployees.Theseuseraccountsquicklybecomeactiveandroutine.Eventsfromrarelyusedusernamescanpointtosuspiciousactivity.Additionally,automatedLinuxfleetstendtoseeactivityfromrarelyusedusernamesonlywhenpersonnellogintomakeauthorizedorunauthorizedchanges,orthreatactorshaveacquiredcredentialsandloginformaliciouspurposes.Unusualusernamescanalsoindicatepivoting,wherecompromisedcredentialsareusedtotryandmovelaterallyfromonehosttoanother.","false_positives":["Uncommonuseractivitycanbeduetoanengineerloggingontoaserverinstanceinordertoperformmanualtroubleshootingorreconfiguration."],"from":"now-45m","interval":"15m","machine_learning_job_id":"linux_anomalous_user_name_ecs","name":"UnusualLinuxUsername","note":"###InvestigatinganUnusualLinuxUser###\nSignalsfromthisruleindicateactivityforaLinuxusernamethatisrareandunusual.Herearesomepossibleavenuesofinvestigation:\n-Considertheuserasidentifiedbytheusernamefield.Isthisprogrampartofanexpectedworkflowfortheuserwhoranthisprogramonthishost?Couldthisberelatedtotroubleshootingordebuggingactivitybyadeveloperorsitereliabilityengineer?\n-Examinethehistoryofuseractivity.Ifthisusermanifestedonlyveryrecently,itmightbeaserviceaccountforanewsoftwarepackage.Ifithasaconsistentcadence-forexampleifitrunsmonthlyorquarterly-itmightbepartofamonthlyorquarterlybusinessprocess.\n-Examinetheprocessarguments,titleandworkingdirectory.Thesemayprovideindicationsastothesourceoftheprogramorthenatureofthetasksthattheuserisperforming.","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"b347b919-665f-4aac-b9e8-68369bf2340c","severity":"low","tags":["Elastic","Linux","ML"],"type":"machine_learning","version":1}
{"description":"Adversariesmayattempttodisabletheiptablesorfirewallserviceinanattempttoaffecthowahostisallowedtoreceiveorsendnetworktraffic.","index":["auditbeat-*"],"language":"kuery","name":"AttempttoDisableIPTablesorFirewall","query":"event.action:(executedorprocess_started)and(process.name:serviceandprocess.args:stoporprocess.name:chkconfigandprocess.args:off)andprocess.args:(ip6tablesoriptables)orprocess.name:systemctlandprocess.args:(firewalldand(disableorstoporkill))","risk_score":47,"rule_id":"125417b8-d3df-479f-8418-12d7e034fee3","severity":"medium","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1089","name":"DisablingSecurityTools","reference":"https://attack.mitre.org/techniques/T1089/"}]}],"type":"query","version":1}
{"description":"Adversariesmayattempttodisablethesyslogserviceinanattempttoanattempttodisrupteventloggingandevadedetectionbysecuritycontrols.","index":["auditbeat-*"],"language":"kuery","name":"AttempttoDisableSyslogService","query":"event.action:(executedorprocess_started)and((process.name:serviceandprocess.args:stop)or(process.name:chkconfigandprocess.args:off)or(process.name:systemctlandprocess.args:(disableorstoporkill)))andprocess.args:(syslogorrsyslogor\"syslog-ng\")","risk_score":47,"rule_id":"2f8a1226-5720-437d-9c20-e0029deb6194","severity":"medium","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1089","name":"DisablingSecurityTools","reference":"https://attack.mitre.org/techniques/T1089/"}]}],"type":"query","version":1}
{"description":"Adversariesmayencode/decodedatainanattempttoevadedetectionbyhost-ornetwork-basedsecuritycontrols.","false_positives":["AutomatedtoolssuchasJenkinsmayencodeordecodefilesaspartoftheirnormalbehavior.Theseeventscanbefilteredbytheprocessexecutableorusernamevalues."],"index":["auditbeat-*"],"language":"kuery","name":"Base16orBase32Encoding/DecodingActivity","query":"event.action:(executedorprocess_started)andprocess.name:(base16orbase32orbase32plainorbase32hex)","risk_score":21,"rule_id":"debff20a-46bc-4a4d-bae5-5cdd14222795","severity":"low","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1140","name":"Deobfuscate/DecodeFilesorInformation","reference":"https://attack.mitre.org/techniques/T1140/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1027","name":"ObfuscatedFilesorInformation","reference":"https://attack.mitre.org/techniques/T1027/"}]}],"type":"query","version":1}
{"description":"Adversariesmayencode/decodedatainanattempttoevadedetectionbyhost-ornetwork-basedsecuritycontrols.","false_positives":["AutomatedtoolssuchasJenkinsmayencodeordecodefilesaspartoftheirnormalbehavior.Theseeventscanbefilteredbytheprocessexecutableorusernamevalues."],"index":["auditbeat-*"],"language":"kuery","name":"Base64Encoding/DecodingActivity","query":"event.action:(executedorprocess_started)andprocess.name:(base64orbase64plainorbase64urlorbase64mimeorbase64pem)","risk_score":21,"rule_id":"97f22dab-84e8-409d-955e-dacd1d31670b","severity":"low","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1140","name":"Deobfuscate/DecodeFilesorInformation","reference":"https://attack.mitre.org/techniques/T1140/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1027","name":"ObfuscatedFilesorInformation","reference":"https://attack.mitre.org/techniques/T1027/"}]}],"type":"query","version":1}
{"description":"IdentifiespotentialattemptstodisableSecurity-EnhancedLinux(SELinux),whichisaLinuxkernelsecurityfeaturetosupportaccesscontrolpolicies.Adversariesmaydisablesecuritytoolstoavoidpossibledetectionoftheirtoolsandactivities.","index":["auditbeat-*"],"language":"kuery","name":"PotentialDisablingofSELinux","query":"event.action:executedandprocess.name:setenforceandprocess.args:0","risk_score":47,"rule_id":"eb9eb8ba-a983-41d9-9c93-a1c05112ca5e","severity":"medium","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1089","name":"DisablingSecurityTools","reference":"https://attack.mitre.org/techniques/T1089/"}]}],"type":"query","version":1}
{"description":"Malwareorotherfilesdroppedorcreatedonasystembyanadversarymayleavetracesbehindastowhatwasdonewithinanetworkandhow.Adversariesmayremovethesefilesoverthecourseofanintrusiontokeeptheirfootprintloworremovethemattheendaspartofthepost-intrusioncleanupprocess.","index":["auditbeat-*"],"language":"kuery","name":"FileDeletionviaShred","query":"event.action:(executedorprocess_started)andprocess.name:shredandprocess.args:(\"-u\"or\"--remove\"or\"-z\"or\"--zero\")","risk_score":21,"rule_id":"a1329140-8de3-4445-9f87-908fb6d824f4","severity":"low","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1107","name":"FileDeletion","reference":"https://attack.mitre.org/techniques/T1107/"}]}],"type":"query","version":1}
{"description":"Identifiesfilepermissionmodificationsincommonwritabledirectoriesbyanon-rootuser.Adversariesoftendropfilesorpayloadsintoawritabledirectoryandchangepermissionspriortoexecution.","false_positives":["Certainprogramsorapplicationsmaymodifyfilesorchangeownershipinwritabledirectories.Thesecanbeexemptedbyusername."],"index":["auditbeat-*"],"language":"kuery","name":"FilePermissionModificationinWritableDirectory","query":"event.action:executedandprocess.name:(chmodorchownorchattrorchgrp)andprocess.working_directory:(/tmpor/var/tmpor/dev/shm)andnotuser.name:root","risk_score":21,"rule_id":"9f9a2a82-93a8-4b1a-8778-1780895626d4","severity":"low","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1222","name":"FileandDirectoryPermissionsModification","reference":"https://attack.mitre.org/techniques/T1222/"}]}],"type":"query","version":1}
{"description":"Adversariesmayencode/decodedatainanattempttoevadedetectionbyhost-ornetwork-basedsecuritycontrols.","false_positives":["AutomatedtoolssuchasJenkinsmayencodeordecodefilesaspartoftheirnormalbehavior.Theseeventscanbefilteredbytheprocessexecutableorusernamevalues."],"index":["auditbeat-*"],"language":"kuery","name":"HexEncoding/DecodingActivity","query":"event.action:(executedorprocess_started)andprocess.name:(hexorxxd)","risk_score":21,"rule_id":"a9198571-b135-4a76-b055-e3e5a476fd83","severity":"low","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1140","name":"Deobfuscate/DecodeFilesorInformation","reference":"https://attack.mitre.org/techniques/T1140/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1027","name":"ObfuscatedFilesorInformation","reference":"https://attack.mitre.org/techniques/T1027/"}]}],"type":"query","version":1}
{"description":"HpingranonaLinuxhost.HpingisaFOSScommand-linepacketanalyzerandhastheabilitytoconstructnetworkpacketsforawidevarietyofnetworksecuritytestingapplications,includingscanningandfirewallauditing.","false_positives":["Normaluseofhpingisuncommonapartfromsecuritytestingandresearch.Usebynon-securityengineersisveryuncommon."],"index":["auditbeat-*"],"language":"kuery","name":"HpingProcessActivity","query":"process.name:(hpingorhping2orhping3)andevent.action:executed","references":["https://en.wikipedia.org/wiki/Hping"],"risk_score":73,"rule_id":"90169566-2260-4824-b8e4-8615c3b4ed52","severity":"high","tags":["Elastic","Linux"],"type":"query","version":2}
{"description":"IodineisatoolfortunnelingInternetprotocolversion4(IPV4)trafficovertheDNSprotocoltocircumventfirewalls,networksecuritygroups,andnetworkaccesslistswhileevadingdetection.","false_positives":["NormaluseofIodineisuncommonapartfromsecuritytestingandresearch.Usebynon-securityengineersisveryuncommon."],"index":["auditbeat-*"],"language":"kuery","name":"PotentialDNSTunnelingviaIodine","query":"process.name:(iodineoriodined)andevent.action:executed","references":["https://code.kryo.se/iodine/"],"risk_score":73,"rule_id":"041d4d41-9589-43e2-ba13-5680af75ebc2","severity":"high","tags":["Elastic","Linux"],"type":"query","version":2}
{"description":"Identifiesloadablekernelmoduleerrors,whichareoftenindicativeofpotentialpersistenceattempts.","false_positives":["Securitytoolsanddevicedriversmayruntheseprogramsinordertoloadlegitimatekernelmodules.Useoftheseprogramsbyordinaryusersisuncommon."],"index":["auditbeat-*"],"language":"kuery","name":"PersistenceviaKernelModuleModification","query":"process.name:(insmodorkmodormodprobeorrmod)andevent.action:executed","references":["https://www.hackers-arise.com/single-post/2017/11/03/Linux-for-Hackers-Part-10-Loadable-Kernel-Modules-LKM"],"risk_score":21,"rule_id":"81cc58f5-8062-49a2-ba84-5cc4b4d31c40","severity":"low","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/techniques/TA0003/"},"technique":[{"id":"T1215","name":"KernelModulesandExtensions","reference":"https://attack.mitre.org/techniques/T1215/"}]}],"type":"query","version":2}
{"description":"LoadableKernelModules(orLKMs)arepiecesofcodethatcanbeloadedandunloadedintothekernelupondemand.Theyextendthefunctionalityofthekernelwithouttheneedtorebootthesystem.Thisidentifiesattemptstoenumerateinformationaboutakernelmodule.","false_positives":["Securitytoolsanddevicedriversmayruntheseprogramsinordertoenumeratekernelmodules.Useoftheseprogramsbyordinaryusersisuncommon.Thesecanbeexemptedbyprocessnameorusername."],"index":["auditbeat-*"],"language":"kuery","name":"EnumerationofKernelModules","query":"event.action:executedandprocess.args:(kmodandlistandsudoorsudoand(depmodorlsmodormodinfo))","risk_score":47,"rule_id":"2d8043ed-5bda-4caf-801c-c1feb7410504","severity":"medium","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1082","name":"SystemInformationDiscovery","reference":"https://attack.mitre.org/techniques/T1082/"}]}],"type":"query","version":1}
{"description":"Kernelmodulesarepiecesofcodethatcanbeloadedandunloadedintothekernelupondemand.Theyextendthefunctionalityofthekernelwithouttheneedtorebootthesystem.Thisruleidentifiesattemptstoremoveakernelmodule.","false_positives":["Thereisusuallynoreasontoremovemodules,butsomebuggymodulesrequireit.Thesecanbeexemptedbyusername.NotethatsomeLinuxdistributionsarenotbuilttosupporttheremovalofmodulesatall."],"index":["auditbeat-*"],"language":"kuery","name":"KernelModuleRemoval","query":"event.action:executedandprocess.args:(rmmodandsudoormodprobeandsudoand(\"--remove\"or\"-r\"))","references":["http://man7.org/linux/man-pages/man8/modprobe.8.html"],"risk_score":73,"rule_id":"cd66a5af-e34b-4bb0-8931-57d0a043f2ef","severity":"high","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1089","name":"DisablingSecurityTools","reference":"https://attack.mitre.org/techniques/T1089/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1215","name":"KernelModulesandExtensions","reference":"https://attack.mitre.org/techniques/T1215/"}]}],"type":"query","version":1}
{"description":"TheLinuxmknodprogramissometimesusedinthecommandpayloadofaremotecommandinjection(RCI)andotherexploits.Itisusedtoexportacommandshellwhenthetraditionalversionofnetcatisnotavailabletothepayload.","false_positives":["MknodisaLinuxsystemprogram.Somenormaluseofthisprogram,atvaryinglevelsoffrequency,mayoriginatefromscripts,automationtools,andframeworks.Usagebywebserversismorelikelytobesuspicious."],"index":["auditbeat-*"],"language":"kuery","name":"MknodProcessActivity","query":"process.name:mknodandevent.action:executed","references":["https://pen-testing.sans.org/blog/2013/05/06/netcat-without-e-no-problem"],"risk_score":21,"rule_id":"61c31c14-507f-4627-8c31-072556b89a9c","severity":"low","tags":["Elastic","Linux"],"type":"query","version":2}
{"description":"AnetcatprocessisengaginginnetworkactivityonaLinuxhost.Netcatisoftenusedasapersistencemechanismbyexportingareverseshellorbyservingashellonalisteningport.Netcatisalsosometimesusedfordataexfiltration.","false_positives":["Netcatisadual-usetoolthatcanbeusedforbenignormaliciousactivity.NetcatisincludedinsomeLinuxdistributionssoitspresenceisnotnecessarilysuspicious.Somenormaluseofthisprogram,whileuncommon,mayoriginatefromscripts,automationtools,andframeworks."],"index":["auditbeat-*"],"language":"kuery","name":"NetcatNetworkActivity","query":"process.name:(ncorncatornetcatornetcat.openbsdornetcat.traditional)andevent.action:(bound-socketorconnected-toorsocket_opened)","references":["http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet","https://www.sans.org/security-resources/sec560/netcat_cheat_sheet_v1.pdf","https://en.wikipedia.org/wiki/Netcat"],"risk_score":47,"rule_id":"adb961e0-cb74-42a0-af9e-29fc41f88f5f","severity":"medium","tags":["Elastic","Linux"],"type":"query","version":2}
{"description":"NmapwasexecutedonaLinuxhost.NmapisaFOSStoolfornetworkscanningandsecuritytesting.Itcanmapanddiscovernetworks,andidentifylisteningservicesandoperatingsystems.Itissometimesusedtogatherinformationinsupportofexploitation,executionorlateralmovement.","false_positives":["Securitytestingtoolsandframeworksmayrun`Nmap`inthecourseofsecurityauditing.Somenormaluseofthiscommandmayoriginatefromsecurityengineersandnetworkorserveradministrators.Useofnmapbyordinaryusersisuncommon."],"index":["auditbeat-*"],"language":"kuery","name":"NmapProcessActivity","query":"process.name:nmap","references":["https://en.wikipedia.org/wiki/Nmap"],"risk_score":21,"rule_id":"c87fca17-b3a9-4e83-b545-f30746c53920","severity":"low","tags":["Elastic","Linux"],"type":"query","version":2}
{"description":"NpingranonaLinuxhost.NpingispartoftheNmaptoolsuiteandhastheabilitytoconstructrawpacketsforawidevarietyofsecuritytestingapplications,includingdenialofservicetesting.","false_positives":["Somenormaluseofthiscommandmayoriginatefromsecurityengineersandnetworkorserveradministrators,butthisisusuallynotroutineorunannounced.Useof`Nping`bynon-engineersorordinaryusersisuncommon."],"index":["auditbeat-*"],"language":"kuery","name":"NpingProcessActivity","query":"process.name:npingandevent.action:executed","references":["https://en.wikipedia.org/wiki/Nmap"],"risk_score":47,"rule_id":"0d69150b-96f8-467c-a86d-a67a3378ce77","severity":"medium","tags":["Elastic","Linux"],"type":"query","version":2}
{"description":"Identifieswhenaterminal(tty)isspawnedviaPerl.Attackersmayupgradeasimplereverseshelltoafullyinteractivettyafterobtaininginitialaccesstoahost.","index":["auditbeat-*"],"language":"kuery","name":"InteractiveTerminalSpawnedviaPerl","query":"event.action:executedandprocess.name:perlandprocess.args:(\"exec\\\"/bin/sh\\\";\"or\"exec\\\"/bin/dash\\\";\"or\"exec\\\"/bin/bash\\\";\")","risk_score":73,"rule_id":"05e5a668-7b51-4a67-93ab-e9af405c9ef3","severity":"high","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1059","name":"Command-LineInterface","reference":"https://attack.mitre.org/techniques/T1059/"}]}],"type":"query","version":1}
{"description":"Identifiesprocessesrunninginatemporaryfolder.Thisissometimesdonebyadversariestohidemalware.","false_positives":["Buildsystems,likeJenkins,maystartprocessesinthe`/tmp`directory.Thesecanbeexemptedbynameorbyusername."],"index":["auditbeat-*"],"language":"kuery","name":"UnusualProcessExecution-Temp","query":"process.working_directory:/tmpandevent.action:executed","risk_score":47,"rule_id":"df959768-b0c9-4d45-988c-5606a2be8e5a","severity":"medium","tags":["Elastic","Linux"],"type":"query","version":2}
{"description":"Identifieswhenaterminal(tty)isspawnedviaPython.Attackersmayupgradeasimplereverseshelltoafullyinteractivettyafterobtaininginitialaccesstoahost.","index":["auditbeat-*"],"language":"kuery","name":"InteractiveTerminalSpawnedviaPython","query":"event.action:executedandprocess.name:pythonandprocess.args:(\"importpty;pty.spawn(\\\"/bin/sh\\\")\"or\"importpty;pty.spawn(\\\"/bin/dash\\\")\"or\"importpty;pty.spawn(\\\"/bin/bash\\\")\")","risk_score":73,"rule_id":"d76b02ef-fc95-4001-9297-01cb7412232f","severity":"high","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1059","name":"Command-LineInterface","reference":"https://attack.mitre.org/techniques/T1059/"}]}],"type":"query","version":1}
{"description":"Anadversarymayaddthesetgidbittoafileordirectoryinordertorunafilewiththeprivilegesoftheowninggroup.Anadversarycantakeadvantageofthistoeitherdoashellescapeorexploitavulnerabilityinanapplicationwiththesetgidbittogetcoderunninginadifferentuser\u2019scontext.Additionally,adversariescanusethismechanismontheirownmalwaretomakesurethey'reabletoexecuteinelevatedcontextsinthefuture.","index":["auditbeat-*"],"language":"lucene","max_signals":33,"name":"SetgidBitSetviachmod","query":"event.action:(executedORprocess_started)ANDprocess.name:chmodANDprocess.args:(g+sOR/2[0-9]{3}/)ANDNOTuser.name:root","risk_score":21,"rule_id":"3a86e085-094c-412d-97ff-2439731e59cb","severity":"low","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0004","name":"PrivilegeEscalation","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1166","name":"SetuidandSetgid","reference":"https://attack.mitre.org/techniques/T1166/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0004","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1166","name":"SetuidandSetgid","reference":"https://attack.mitre.org/techniques/T1166/"}]}],"type":"query","version":1}
{"description":"Anadversarymayaddthesetuidbittoafileordirectoryinordertorunafilewiththeprivilegesoftheowninguser.Anadversarycantakeadvantageofthistoeitherdoashellescapeorexploitavulnerabilityinanapplicationwiththesetuidbittogetcoderunninginadifferentuser\u2019scontext.Additionally,adversariescanusethismechanismontheirownmalwaretomakesurethey'reabletoexecuteinelevatedcontextsinthefuture.","index":["auditbeat-*"],"language":"lucene","max_signals":33,"name":"SetuidBitSetviachmod","query":"event.action:(executedORprocess_started)ANDprocess.name:chmodANDprocess.args:(u+sOR/4[0-9]{3}/)ANDNOTuser.name:root","risk_score":21,"rule_id":"8a1b0278-0f9a-487d-96bd-d4833298e87a","severity":"low","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0004","name":"PrivilegeEscalation","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1166","name":"SetuidandSetgid","reference":"https://attack.mitre.org/techniques/T1166/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0004","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1166","name":"SetuidandSetgid","reference":"https://attack.mitre.org/techniques/T1166/"}]}],"type":"query","version":1}
{"description":"Identifiessuspiciouscommandsexecutedviaawebserver,whichmaysuggestavulnerabilityandremoteshellaccess.","false_positives":["Networkmonitoringormanagementproductsmayhaveawebservercomponentthatrunsshellcommandsaspartofnormalbehavior."],"index":["auditbeat-*"],"language":"kuery","name":"PotentialShellviaWebServer","query":"process.name:(bashordash)anduser.name:(apacheornginxorwwwor\"www-data\")andevent.action:executed","references":["https://pentestlab.blog/tag/web-shell/"],"risk_score":47,"rule_id":"231876e7-4d1f-4d63-a47c-47dd1acdc1cb","severity":"medium","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/techniques/TA0003/"},"technique":[{"id":"T1100","name":"WebShell","reference":"https://attack.mitre.org/techniques/T1100/"}]}],"type":"query","version":3}
{"description":"ASocatprocessisrunningonaLinuxhost.Socatisoftenusedasapersistencemechanismbyexportingareverseshell,orbyservingashellonalisteningport.Socatisalsosometimesusedforlateralmovement.","false_positives":["Socatisadual-usetoolthatcanbeusedforbenignormaliciousactivity.Somenormaluseofthisprogram,atvaryinglevelsoffrequency,mayoriginatefromscripts,automationtools,andframeworks.Usagebywebserversismorelikelytobesuspicious."],"index":["auditbeat-*"],"language":"kuery","name":"SocatProcessActivity","query":"process.name:socatandnotprocess.args:-Vandevent.action:executed","references":["https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/#method-2-using-socat"],"risk_score":47,"rule_id":"cd4d5754-07e1-41d4-b9a5-ef4ea6a0a126","severity":"medium","tags":["Elastic","Linux"],"type":"query","version":2}
{"description":"Stracerunsinaprivilegedcontextandcanbeusedtoescaperestrictiveenvironmentsbyinstantiatingashellinordertoelevateprivilegesormovelaterally.","false_positives":["Straceisadual-usetoolthatcanbeusedforbenignormaliciousactivity.SomenormaluseofthiscommandmayoriginatefromdevelopersorSREsengagedindebuggingorsystemcalltracing."],"index":["auditbeat-*"],"language":"kuery","name":"StraceProcessActivity","query":"process.name:straceandevent.action:executed","references":["https://en.wikipedia.org/wiki/Strace"],"risk_score":21,"rule_id":"d6450d4e-81c6-46a3-bd94-079886318ed5","severity":"low","tags":["Elastic","Linux"],"type":"query","version":2}
{"description":"Asudoersfilespecifiesthecommandsthatusersorgroupscanrunandfromwhichterminals.Adversariescantakeadvantageoftheseconfigurationstoexecutecommandsasotherusersorspawnprocesseswithhigherprivileges.","index":["auditbeat-*"],"language":"kuery","name":"SudoersFileModification","query":"event.module:file_integrityandevent.action:updatedandfile.path:/etc/sudoers","risk_score":21,"rule_id":"931e25a5-0f5e-4ae0-ba0d-9e94eff7e3a4","severity":"low","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0004","name":"PrivilegeEscalation","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1169","name":"Sudo","reference":"https://attack.mitre.org/techniques/T1169/"}]}],"type":"query","version":1}
{"description":"TheTcpdumpprogramranonaLinuxhost.Tcpdumpisanetworkmonitoringorpacketsniffingtoolthatcanbeusedtocaptureinsecurecredentialsordatainmotion.Sniffingcanalsobeusedtodiscoverdetailsofnetworkservicesasapreludetolateralmovementordefenseevasion.","false_positives":["Somenormaluseofthiscommandmayoriginatefromserverornetworkadministratorsengagedinnetworktroubleshooting."],"index":["auditbeat-*"],"language":"kuery","name":"NetworkSniffingviaTcpdump","query":"process.name:tcpdumpandevent.action:executed","risk_score":21,"rule_id":"7a137d76-ce3d-48e2-947d-2747796a78c0","severity":"low","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0006","name":"CredentialAccess","reference":"https://attack.mitre.org/tactics/TA0006/"},"technique":[{"id":"T1040","name":"NetworkSniffing","reference":"https://attack.mitre.org/techniques/T1040/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1040","name":"NetworkSniffing","reference":"https://attack.mitre.org/techniques/T1040/"}]}],"type":"query","version":2}
{"description":"Telnetprovidesacommandlineinterfaceforcommunicationwitharemotedeviceorserver.ThisruleidentifiesTelnetnetworkconnectionstopubliclyroutableIPaddresses.","false_positives":["Telnetcanbeusedforbothbenignormaliciouspurposes.TelnetisincludedbydefaultinsomeLinuxdistributions,soitspresenceisnotinherentlysuspicious.TheuseofTelnettomanagedevicesremotelyhasdeclinedinrecentyearsinfavorofmoresecureprotocolssuchasSSH.Telnetusagebynon-automatedtoolsorframeworksmaybesuspicious."],"index":["auditbeat-*"],"language":"kuery","name":"ConnectiontoExternalNetworkviaTelnet","query":"event.action:(\"connected-to\"or\"network_flow\")andprocess.name:telnetandnotdestination.ip:(127.0.0.0/8or10.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"FE80::/10\"or\"::1/128\")","risk_score":47,"rule_id":"e19e64ee-130e-4c07-961f-8a339f0b8362","severity":"medium","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0008","name":"LateralMovement","reference":"https://attack.mitre.org/tactics/TA0008/"},"technique":[{"id":"T1021","name":"RemoteServices","reference":"https://attack.mitre.org/techniques/T1021/"}]}],"type":"query","version":1}
{"description":"Telnetprovidesacommandlineinterfaceforcommunicationwitharemotedeviceorserver.ThisruleidentifiesTelnetnetworkconnectionstonon-publiclyroutableIPaddresses.","false_positives":["Telnetcanbeusedforbothbenignormaliciouspurposes.TelnetisincludedbydefaultinsomeLinuxdistributions,soitspresenceisnotinherentlysuspicious.TheuseofTelnettomanagedevicesremotelyhasdeclinedinrecentyearsinfavorofmoresecureprotocolssuchasSSH.Telnetusagebynon-automatedtoolsorframeworksmaybesuspicious."],"index":["auditbeat-*"],"language":"kuery","name":"ConnectiontoInternalNetworkviaTelnet","query":"event.action:(\"connected-to\"or\"network_flow\")andprocess.name:telnetanddestination.ip:((10.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"FE80::/10\")andnot(127.0.0.0/8or\"::1/128\"))","risk_score":47,"rule_id":"1b21abcc-4d9f-4b08-a7f5-316f5f94b973","severity":"medium","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0008","name":"LateralMovement","reference":"https://attack.mitre.org/tactics/TA0008/"},"technique":[{"id":"T1021","name":"RemoteServices","reference":"https://attack.mitre.org/techniques/T1021/"}]}],"type":"query","version":1}
{"description":"Anadversarymayattempttogetdetailedinformationabouttheoperatingsystemandhardware.Thisruleidentifiescommonlocationsusedtodiscovervirtualmachinehardwarebyanon-rootuser.ThistechniquehasbeenusedbythePupyRATandothermalware.","false_positives":["Certaintoolsorautomatedsoftwaremayenumeratehardwareinformation.Thesetoolscanbeexemptedviausernameorprocessargumentstoeliminatepotentialnoise."],"index":["auditbeat-*"],"language":"kuery","name":"VirtualMachineFingerprinting","query":"event.action:executedandprocess.args:(\"/sys/class/dmi/id/bios_version\"or\"/sys/class/dmi/id/product_name\"or\"/sys/class/dmi/id/chassis_vendor\"or\"/proc/scsi/scsi\"or\"/proc/ide/hd0/model\")andnotuser.name:root","risk_score":73,"rule_id":"5b03c9fb-9945-4d2f-9568-fd690fee3fba","severity":"high","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1082","name":"SystemInformationDiscovery","reference":"https://attack.mitre.org/techniques/T1082/"}]}],"type":"query","version":1}
{"description":"ThewhoamiapplicationwasexecutedonaLinuxhost.Thisisoftenusedbytoolsandpersistencemechanismstotestforprivilegedaccess.","false_positives":["Securitytestingtoolsandframeworksmayrunthiscommand.Somenormaluseofthiscommandmayoriginatefromautomationtoolsandframeworks."],"index":["auditbeat-*"],"language":"kuery","name":"UserDiscoveryviaWhoami","query":"process.name:whoamiandevent.action:executed","risk_score":21,"rule_id":"120559c6-5e24-49f4-9e30-8ffe697df6b9","severity":"low","tags":["Elastic","Linux"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1033","name":"SystemOwner/UserDiscovery","reference":"https://attack.mitre.org/techniques/T1033/"}]}],"type":"query","version":2}
{"description":"ThisruledetectswhenaninternalnetworkclientsendsDNStrafficdirectlytotheInternet.Thisisatypicalbehaviorforamanagednetwork,andcanbeindicativeofmalware,exfiltration,commandandcontrol,or,simply,misconfiguration.ThisDNSactivityalsoimpactsyourorganization'sabilitytoprovideenterprisemonitoringandloggingofDNS,andopensyournetworktoavarietyofabusesandmaliciouscommunications.","false_positives":["ExcludeDNSserversfromthisruleasthisisexpectedbehavior.EndpointsusuallyquerylocalDNSserversdefinedintheirDHCPscopes,butthismaybeoverriddenifauserconfigurestheirendpointtousearemoteDNSserver.ThisisuncommoninmanagedenterprisenetworksbecauseitcouldbreakintranetnameresolutionwhensplithorizonDNSisutilized.SomeconsumerVPNservicesandbrowserplug-insmaysendDNStraffictoremoteInternetdestinations.Inthatcase,suchdevicesornetworkscanbeexcludedfromthisrulewhenthisisexpectedbehavior."],"index":["filebeat-*"],"language":"kuery","name":"DNSActivitytotheInternet","query":"destination.port:53andsource.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)andnotdestination.ip:(10.0.0.0/8or127.0.0.0/8or169.254.169.254/32or172.16.0.0/12or192.168.0.0/16or224.0.0.251or224.0.0.252or255.255.255.255or\"::1\"or\"ff02::fb\")","references":["https://www.us-cert.gov/ncas/alerts/TA15-240A","https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-81-2.pdf"],"risk_score":47,"rule_id":"6ea71ff0-9e95-475b-9506-2580d1ce6154","severity":"medium","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1043","name":"CommonlyUsedPort","reference":"https://attack.mitre.org/techniques/T1043/"}]}],"type":"query","version":3}
{"description":"ThisruledetectseventsthatmayindicatetheuseofFTPnetworkconnectionstotheInternet.TheFileTransferProtocol(FTP)hasbeenaroundinitscurrentformsincethe1980s.Itcanbeacommonandefficientprocedureonyournetworktosendandreceivefiles.Becauseofthis,adversarieswillalsooftenusethisprotocoltoexfiltratedatafromyournetworkordownloadnewtools.Additionally,FTPisaplain-textprotocolwhich,ifintercepted,mayexposeusernamesandpasswords.FTPactivityinvolvingserverssubjecttoregulationsorcompliancestandardsmaybeunauthorized.","false_positives":["FTPserversshouldbeexcludedfromthisruleasthisisexpectedbehavior.SomebusinessworkflowsmayuseFTPfordataexchange.Theseworkflowsoftenhaveexpectedcharacteristicssuchasusers,sources,anddestinations.FTPactivityinvolvinganunusualsourceordestinationmaybemoresuspicious.FTPactivityinvolvingaproductionserverthathasnoknownassociatedFTPworkfloworbusinessrequirementisoftensuspicious."],"index":["filebeat-*"],"language":"kuery","name":"FTP(FileTransferProtocol)ActivitytotheInternet","query":"network.transport:tcpanddestination.port:(20or21)andsource.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)andnotdestination.ip:(10.0.0.0/8or127.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"::1\")","risk_score":21,"rule_id":"87ec6396-9ac4-4706-bcf0-2ebb22002f43","severity":"low","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1043","name":"CommonlyUsedPort","reference":"https://attack.mitre.org/techniques/T1043/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0010","name":"Exfiltration","reference":"https://attack.mitre.org/tactics/TA0010/"},"technique":[{"id":"T1048","name":"ExfiltrationOverAlternativeProtocol","reference":"https://attack.mitre.org/techniques/T1048/"}]}],"type":"query","version":3}
{"description":"ThisruledetectseventsthatusecommonportsforInternetRelayChat(IRC)totheInternet.IRCisacommonprotocolthatcanbeusedforchatandfiletransfers.Thisprotocolisalsoagoodcandidateforremotecontrolofmalwareanddatatransferstoandfromanetwork.","false_positives":["IRCactivitymaybenormalbehaviorfordevelopersandengineersbutisunusualfornon-engineeringendusers.IRCactivityinvolvinganunusualsourceordestinationmaybemoresuspicious.IRCactivityinvolvingaproductionserverisoftensuspicious.Becausetheseportsareintheephemeralrange,thisrulemayfalseundercertainconditions,suchaswhenaNAT-edwebserverrepliestoaclientwhichhasusedaportintherangebycoincidence.Inthiscase,theseserverscanbeexcluded.Somelegacyapplicationsmayusetheseports,butthisisveryuncommonandusuallyonlyappearsinlocaltrafficusingprivateIPs,whichdoesnotmatchthisrule'sconditions."],"index":["filebeat-*"],"language":"kuery","name":"IRC(InternetRelayChat)ProtocolActivitytotheInternet","query":"network.transport:tcpanddestination.port:(6667or6697)andsource.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)andnotdestination.ip:(10.0.0.0/8or127.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"::1\")","risk_score":47,"rule_id":"c6474c34-4953-447a-903e-9fcb7b6661aa","severity":"medium","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1043","name":"CommonlyUsedPort","reference":"https://attack.mitre.org/techniques/T1043/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0010","name":"Exfiltration","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1048","name":"ExfiltrationOverAlternativeProtocol","reference":"https://attack.mitre.org/techniques/T1048/"}]}],"type":"query","version":3}
{"description":"ThisruledetectseventsthatcouldbedescribingIPSECNATTraversaltraffic.IPSECisaVPNtechnologythatallowsonesystemtotalktoanotherusingencryptedtunnels.NATTraversalenablesthesetunnelstocommunicateovertheInternetwhereoneofthesidesisbehindaNATroutergateway.Thismaybecommononyournetwork,butthistechniqueisalsousedbythreatactorstoavoiddetection.","false_positives":["Somenetworksmayutilizetheseprotocolsbutusagethatisunfamiliartolocalnetworkadministratorscanbeunexpectedandsuspicious.Becausethisportisintheephemeralrange,thisrulemayfalseundercertainconditions,suchaswhenanapplicationserverwithapublicIPaddressrepliestoaclientwhichhasusedaUDPportintherangebycoincidence.Thisisuncommonbutsuchserverscanbeexcluded."],"index":["filebeat-*"],"language":"kuery","name":"IPSECNATTraversalPortActivity","query":"network.transport:udpanddestination.port:4500","risk_score":21,"rule_id":"a9cb3641-ff4b-4cdc-a063-b4b8d02a67c7","severity":"low","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1043","name":"CommonlyUsedPort","reference":"https://attack.mitre.org/techniques/T1043/"}]}],"type":"query","version":2}
{"description":"ThisruledetectseventsthatmayindicateuseofSMTPonTCPport26.ThisportiscommonlyusedbyseveralpopularmailtransferagentstodeconflictwiththedefaultSMTPport25.ThisporthasalsobeenusedbyamalwarefamilycalledBadPatchforcommandandcontrolofWindowssystems.","false_positives":["Serversthatprocessemailtrafficmaycausefalsepositivesandshouldbeexcludedfromthisruleasthisisexpectedbehavior."],"index":["filebeat-*"],"language":"kuery","name":"SMTPonPort26/TCP","query":"network.transport:tcpanddestination.port:26","references":["https://unit42.paloaltonetworks.com/unit42-badpatch/","https://isc.sans.edu/forums/diary/Next+up+whats+up+with+TCP+port+26/25564/"],"risk_score":21,"rule_id":"d7e62693-aab9-4f66-a21a-3d79ecdd603d","severity":"low","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1043","name":"CommonlyUsedPort","reference":"https://attack.mitre.org/techniques/T1043/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0010","name":"Exfiltration","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1048","name":"ExfiltrationOverAlternativeProtocol","reference":"https://attack.mitre.org/techniques/T1048/"}]}],"type":"query","version":2}
{"description":"TCPPort8000iscommonlyusedfordevelopmentenvironmentsofwebserversoftware.ItgenerallyshouldnotbeexposeddirectlytotheInternet.IfyouarerunningsoftwarelikethisontheInternet,youshouldconsiderplacingitbehindareverseproxy.","false_positives":["Becausethisportisintheephemeralrange,thisrulemayfalseundercertainconditions,suchaswhenaNATedwebserverrepliestoaclientwhichhasusedaportintherangebycoincidence.Inthiscase,suchserverscanbeexcluded.SomeapplicationsmayusethisportbutthisisveryuncommonandusuallyappearsinlocaltrafficusingprivateIPs,whichthisruledoesnotmatch.Somecloudenvironments,particularlydevelopmentenvironments,mayusethisportwhenVPNsordirectconnectsarenotinuseandcloudinstancesareaccessedacrosstheInternet."],"index":["filebeat-*"],"language":"kuery","name":"TCPPort8000ActivitytotheInternet","query":"network.transport:tcpanddestination.port:8000andsource.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)andnotdestination.ip:(10.0.0.0/8or127.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"::1\")","risk_score":21,"rule_id":"08d5d7e2-740f-44d8-aeda-e41f4263efaf","severity":"low","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1043","name":"CommonlyUsedPort","reference":"https://attack.mitre.org/techniques/T1043/"}]}],"type":"query","version":3}
{"description":"ThisruledetectseventsthatmayindicateuseofaPPTPVPNconnection.Somethreatactorsusethesetypesofconnectionstotunneltheirtrafficwhileavoidingdetection.","false_positives":["SomenetworksmayutilizePPTPprotocolsbutthisisuncommonasmoremodernVPNtechnologiesareavailable.Usagethatisunfamiliartolocalnetworkadministratorscanbeunexpectedandsuspicious.Torrentingapplicationsmayusethisport.Becausethisportisintheephemeralrange,thisrulemayfalseundercertainconditions,suchaswhenanapplicationserverrepliestoaclientthatusedthisportbycoincidence.Thisisuncommonbutsuchserverscanbeexcluded."],"index":["filebeat-*"],"language":"kuery","name":"PPTP(PointtoPointTunnelingProtocol)Activity","query":"network.transport:tcpanddestination.port:1723","risk_score":21,"rule_id":"d2053495-8fe7-4168-b3df-dad844046be3","severity":"low","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1043","name":"CommonlyUsedPort","reference":"https://attack.mitre.org/techniques/T1043/"}]}],"type":"query","version":2}
{"description":"ThisruledetectseventsthatmaydescribenetworkeventsofproxyusetotheInternet.ItincludespopularHTTPproxyportsandSOCKSproxyports.Typically,environmentswilluseaninternalIPaddressforaproxyserver.Itcanalsobeusedtocircumventnetworkcontrolsanddetectionmechanisms.","false_positives":["SomeproxiedapplicationsmayusetheseportsbutthisusuallyoccursinlocaltrafficusingprivateIPswhichthisruledoesnotmatch.Proxiesarewidelyusedasasecuritytechnologybutinenterpriseenvironmentsthisisusuallylocaltrafficwhichthisruledoesnotmatch.Internetproxyservicesusingtheseportscanbewhite-listedifdesired.Somescreenrecordingapplicationsmayusetheseports.Proxyportactivityinvolvinganunusualsourceordestinationmaybemoresuspicious.SomecloudenvironmentsmayusethisportwhenVPNsordirectconnectsarenotinuseandcloudinstancesareaccessedacrosstheInternet.Becausetheseportsareintheephemeralrange,thisrulemayfalseundercertainconditionssuchaswhenaNATedwebserverrepliestoaclientwhichhasusedaportintherangebycoincidence.Inthiscase,suchserverscanbeexcludedifdesired."],"index":["filebeat-*"],"language":"kuery","name":"ProxyPortActivitytotheInternet","query":"network.transport:tcpanddestination.port:(1080or3128or8080)andsource.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)andnotdestination.ip:(10.0.0.0/8or127.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"::1\")","risk_score":47,"rule_id":"ad0e5e75-dd89-4875-8d0a-dfdc1828b5f3","severity":"medium","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1043","name":"CommonlyUsedPort","reference":"https://attack.mitre.org/techniques/T1043/"}]}],"type":"query","version":3}
{"description":"ThisruledetectsnetworkeventsthatmayindicatetheuseofRDPtrafficfromtheInternet.RDPiscommonlyusedbysystemadministratorstoremotelycontrolasystemformaintenanceortousesharedresources.ItshouldalmostneverbedirectlyexposedtotheInternet,asitisfrequentlytargetedandexploitedbythreatactorsasaninitialaccessorback-doorvector.","false_positives":["SomenetworksecuritypoliciesallowRDPdirectlyfromtheInternetbutusagethatisunfamiliartoserverornetworkownerscanbeunexpectedandsuspicious.RDPservicesmaybeexposeddirectlytotheInternetinsomenetworkssuchascloudenvironments.Insuchcases,onlyRDPgateways,bastionsorjumpserversmaybeexpectedexposeRDPdirectlytotheInternetandcanbeexemptedfromthisrule.RDPmayberequiredbysomework-flowssuchasremoteaccessandsupportforspecializedsoftwareproductsandservers.Suchwork-flowsareusuallyknownandnotunexpected."],"index":["filebeat-*"],"language":"kuery","name":"RDP(RemoteDesktopProtocol)fromtheInternet","query":"network.transport:tcpanddestination.port:3389andnotsource.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)anddestination.ip:(10.0.0.0/8or127.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"::1\")","risk_score":47,"rule_id":"8c1bdde8-4204-45c0-9e0c-c85ca3902488","severity":"medium","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1043","name":"CommonlyUsedPort","reference":"https://attack.mitre.org/techniques/T1043/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0008","name":"LateralMovement","reference":"https://attack.mitre.org/tactics/TA0008/"},"technique":[{"id":"T1021","name":"RemoteServices","reference":"https://attack.mitre.org/techniques/T1021/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0001","name":"InitialAccess","reference":"https://attack.mitre.org/tactics/TA0001/"},"technique":[{"id":"T1190","name":"ExploitPublic-FacingApplication","reference":"https://attack.mitre.org/techniques/T1190/"}]}],"type":"query","version":3}
{"description":"ThisruledetectsnetworkeventsthatmayindicatetheuseofRDPtraffictotheInternet.RDPiscommonlyusedbysystemadministratorstoremotelycontrolasystemformaintenanceortousesharedresources.ItshouldalmostneverbedirectlyexposedtotheInternet,asitisfrequentlytargetedandexploitedbythreatactorsasaninitialaccessorback-doorvector.","false_positives":["RDPconnectionsmaybemadedirectlytoInternetdestinationsinordertoaccessWindowscloudserverinstancesbutsuchconnectionsareusuallymadeonlybyengineers.Insuchcases,onlyRDPgateways,bastionsorjumpserversmaybeexpectedInternetdestinationsandcanbeexemptedfromthisrule.RDPmayberequiredbysomework-flowssuchasremoteaccessandsupportforspecializedsoftwareproductsandservers.Suchwork-flowsareusuallyknownandnotunexpected.Usagethatisunfamiliartoserverornetworkownerscanbeunexpectedandsuspicious."],"index":["filebeat-*"],"language":"kuery","name":"RDP(RemoteDesktopProtocol)totheInternet","query":"network.transport:tcpanddestination.port:3389andsource.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)andnotdestination.ip:(10.0.0.0/8or127.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"::1\")","risk_score":21,"rule_id":"e56993d2-759c-4120-984c-9ec9bb940fd5","severity":"low","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"InitialAccess","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1043","name":"ExploitPublic-FacingApplication","reference":"https://attack.mitre.org/techniques/T1043/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0010","name":"Exfiltration","reference":"https://attack.mitre.org/tactics/TA0010/"},"technique":[{"id":"T1048","name":"ExfiltrationOverAlternativeProtocol","reference":"https://attack.mitre.org/techniques/T1048/"}]}],"type":"query","version":3}
{"description":"ThisruledetectsnetworkeventsthatmayindicatetheuseofRPCtrafficfromtheInternet.RPCiscommonlyusedbysystemadministratorstoremotelycontrolasystemformaintenanceortousesharedresources.ItshouldalmostneverbedirectlyexposedtotheInternet,asitisfrequentlytargetedandexploitedbythreatactorsasaninitialaccessorback-doorvector.","index":["filebeat-*"],"language":"kuery","name":"RPC(RemoteProcedureCall)fromtheInternet","query":"network.transport:tcpanddestination.port:135andnotsource.ip:(10.0.0.0/8or127.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"::1\")anddestination.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)","risk_score":73,"rule_id":"143cb236-0956-4f42-a706-814bcaa0cf5a","severity":"high","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"InitialAccess","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1190","name":"ExploitPublic-FacingApplication","reference":"https://attack.mitre.org/techniques/T1190/"}]}],"type":"query","version":3}
{"description":"ThisruledetectsnetworkeventsthatmayindicatetheuseofRPCtraffictotheInternet.RPCiscommonlyusedbysystemadministratorstoremotelycontrolasystemformaintenanceortousesharedresources.ItshouldalmostneverbedirectlyexposedtotheInternet,asitisfrequentlytargetedandexploitedbythreatactorsasaninitialaccessorback-doorvector.","index":["filebeat-*"],"language":"kuery","name":"RPC(RemoteProcedureCall)totheInternet","query":"network.transport:tcpanddestination.port:135andsource.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)andnotdestination.ip:(10.0.0.0/8or127.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"::1\")","risk_score":73,"rule_id":"32923416-763a-4531-bb35-f33b9232ecdb","severity":"high","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"InitialAccess","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1190","name":"ExploitPublic-FacingApplication","reference":"https://attack.mitre.org/techniques/T1190/"}]}],"type":"query","version":3}
{"description":"ThisruledetectsnetworkeventsthatmayindicatetheuseofWindowsfilesharing(alsocalledSMBorCIFS)traffictotheInternet.SMBiscommonlyusedwithinnetworkstosharefiles,printers,andothersystemresourcesamongsttrustedsystems.ItshouldalmostneverbedirectlyexposedtotheInternet,asitisfrequentlytargetedandexploitedbythreatactorsasaninitialaccessorback-doorvectororfordataexfiltration.","index":["filebeat-*"],"language":"kuery","name":"SMB(WindowsFileSharing)ActivitytotheInternet","query":"network.transport:tcpanddestination.port:(139or445)andsource.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)andnotdestination.ip:(10.0.0.0/8or127.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"::1\")","risk_score":73,"rule_id":"c82b2bd8-d701-420c-ba43-f11a155b681a","severity":"high","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"InitialAccess","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1190","name":"ExploitPublic-FacingApplication","reference":"https://attack.mitre.org/techniques/T1190/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0010","name":"Exfiltration","reference":"https://attack.mitre.org/tactics/TA0010/"},"technique":[{"id":"T1048","name":"ExfiltrationOverAlternativeProtocol","reference":"https://attack.mitre.org/techniques/T1048/"}]}],"type":"query","version":3}
{"description":"ThisruledetectseventsthatmaydescribeSMTPtrafficfrominternalhoststoahostacrosstheInternet.Inanenterprisenetwork,thereistypicallyadedicatedinternalhostthatperformsthisfunction.Itisalsofrequentlyabusedbythreatactorsforcommandandcontrol,ordataexfiltration.","false_positives":["NATedserversthatprocessemailtrafficmayfalseandshouldbeexcludedfromthisruleasthisisexpectedbehaviorforthem.ConsumerandpersonaldevicesmaysendemailtraffictoremoteInternetdestinations.Inthiscase,suchdevicesornetworkscanbeexcludedfromthisruleifthisisexpectedbehavior."],"index":["filebeat-*"],"language":"kuery","name":"SMTPtotheInternet","query":"network.transport:tcpanddestination.port:(25or465or587)andsource.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)andnotdestination.ip:(10.0.0.0/8or127.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"::1\")","risk_score":21,"rule_id":"67a9beba-830d-4035-bfe8-40b7e28f8ac4","severity":"low","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1043","name":"CommonlyUsedPort","reference":"https://attack.mitre.org/techniques/T1043/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0010","name":"Exfiltration","reference":"https://attack.mitre.org/tactics/TA0010/"},"technique":[{"id":"T1048","name":"ExfiltrationOverAlternativeProtocol","reference":"https://attack.mitre.org/techniques/T1048/"}]}],"type":"query","version":3}
{"description":"Thisruledetectseventsthatmaydescribedatabasetraffic(MSSQL,Oracle,MySQL,andPostgresql)acrosstheInternet.DatabasesshouldalmostneverbedirectlyexposedtotheInternet,astheyarefrequentlytargetedbythreatactorstogaininitialaccesstonetworkresources.","false_positives":["Becausetheseportsareintheephemeralrange,thisrulemayfalseundercertainconditionssuchaswhenaNATedwebserverrepliestoaclientwhichhasusedaportintherangebycoincidence.Inthiscase,suchserverscanbeexcludedifdesired.SomecloudenvironmentsmayusethisportwhenVPNsordirectconnectsarenotinuseanddatabaseinstancesareaccesseddirectlyacrosstheInternet."],"index":["filebeat-*"],"language":"kuery","name":"SQLTraffictotheInternet","query":"network.transport:tcpanddestination.port:(1433or1521or3336or5432)andsource.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)andnotdestination.ip:(10.0.0.0/8or127.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"::1\")","risk_score":47,"rule_id":"139c7458-566a-410c-a5cd-f80238d6a5cd","severity":"medium","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1043","name":"CommonlyUsedPort","reference":"https://attack.mitre.org/techniques/T1043/"}]}],"type":"query","version":3}
{"description":"ThisruledetectsnetworkeventsthatmayindicatetheuseofSSHtrafficfromtheInternet.SSHiscommonlyusedbysystemadministratorstoremotelycontrolasystemusingthecommandlineshell.IfitisexposedtotheInternet,itshouldbedonewithstrongsecuritycontrolsasitisfrequentlytargetedandexploitedbythreatactorsasaninitialaccessorback-doorvector.","false_positives":["SomenetworksecuritypoliciesallowSSHdirectlyfromtheInternetbutusagethatisunfamiliartoserverornetworkownerscanbeunexpectedandsuspicious.SSHservicesmaybeexposeddirectlytotheInternetinsomenetworkssuchascloudenvironments.Insuchcases,onlySSHgateways,bastionsorjumpserversmaybeexpectedexposeSSHdirectlytotheInternetandcanbeexemptedfromthisrule.SSHmayberequiredbysomework-flowssuchasremoteaccessandsupportforspecializedsoftwareproductsandservers.Suchwork-flowsareusuallyknownandnotunexpected."],"index":["filebeat-*"],"language":"kuery","name":"SSH(SecureShell)fromtheInternet","query":"network.transport:tcpanddestination.port:22andnotsource.ip:(10.0.0.0/8or127.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"::1\")anddestination.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)","risk_score":47,"rule_id":"ea0784f0-a4d7-4fea-ae86-4baaf27a6f17","severity":"medium","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1043","name":"CommonlyUsedPort","reference":"https://attack.mitre.org/techniques/T1043/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0008","name":"LateralMovement","reference":"https://attack.mitre.org/tactics/TA0008/"},"technique":[{"id":"T1021","name":"RemoteServices","reference":"https://attack.mitre.org/techniques/T1021/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0001","name":"InitialAccess","reference":"https://attack.mitre.org/tactics/TA0001/"},"technique":[{"id":"T1190","name":"ExploitPublic-FacingApplication","reference":"https://attack.mitre.org/techniques/T1190/"}]}],"type":"query","version":3}
{"description":"ThisruledetectsnetworkeventsthatmayindicatetheuseofSSHtrafficfromtheInternet.SSHiscommonlyusedbysystemadministratorstoremotelycontrolasystemusingthecommandlineshell.IfitisexposedtotheInternet,itshouldbedonewithstrongsecuritycontrolsasitisfrequentlytargetedandexploitedbythreatactorsasaninitialaccessorback-doorvector.","false_positives":["SSHconnectionsmaybemadedirectlytoInternetdestinationsinordertoaccessLinuxcloudserverinstancesbutsuchconnectionsareusuallymadeonlybyengineers.Insuchcases,onlySSHgateways,bastionsorjumpserversmaybeexpectedInternetdestinationsandcanbeexemptedfromthisrule.SSHmayberequiredbysomework-flowssuchasremoteaccessandsupportforspecializedsoftwareproductsandservers.Suchwork-flowsareusuallyknownandnotunexpected.Usagethatisunfamiliartoserverornetworkownerscanbeunexpectedandsuspicious."],"index":["filebeat-*"],"language":"kuery","name":"SSH(SecureShell)totheInternet","query":"network.transport:tcpanddestination.port:22andsource.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)andnotdestination.ip:(10.0.0.0/8or127.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"::1\")","risk_score":21,"rule_id":"6f1500bc-62d7-4eb9-8601-7485e87da2f4","severity":"low","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1043","name":"CommonlyUsedPort","reference":"https://attack.mitre.org/techniques/T1043/"}]}],"type":"query","version":3}
{"description":"ThisruledetectsnetworkeventsthatmayindicatetheuseofTelnettraffic.Telnetiscommonlyusedbysystemadministratorstoremotelycontrololderorembededsystemsusingthecommandlineshell.ItshouldalmostneverbedirectlyexposedtotheInternet,asitisfrequentlytargetedandexploitedbythreatactorsasaninitialaccessorback-doorvector.Asaplain-textprotocol,itmayalsoexposeusernamesandpasswordstoanyonecapableofobservingthetraffic.","false_positives":["IoT(InternetofThings)devicesandnetworksmayusetelnetandcanbeexcludedifdesired.Somebusinesswork-flowsmayuseTelnetforadministrationofolderdevices.Theseoftenhaveapredictablebehavior.Telnetactivityinvolvinganunusualsourceordestinationmaybemoresuspicious.TelnetactivityinvolvingaproductionserverthathasnoknownassociatedTelnetwork-floworbusinessrequirementisoftensuspicious."],"index":["filebeat-*"],"language":"kuery","name":"TelnetPortActivity","query":"network.transport:tcpanddestination.port:23","risk_score":47,"rule_id":"34fde489-94b0-4500-a76f-b8a157cf9269","severity":"medium","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1043","name":"CommonlyUsedPort","reference":"https://attack.mitre.org/techniques/T1043/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0008","name":"LateralMovement","reference":"https://attack.mitre.org/tactics/TA0008/"},"technique":[{"id":"T1021","name":"RemoteServices","reference":"https://attack.mitre.org/techniques/T1021/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"InitialAccess","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1190","name":"ExploitPublic-FacingApplication","reference":"https://attack.mitre.org/techniques/T1190/"}]}],"type":"query","version":2}
{"description":"ThisruledetectsnetworkeventsthatmayindicatetheuseofTortraffictotheInternet.Torisanetworkprotocolthatsendstrafficthroughaseriesofencryptedtunnelsusedtoconcealauser'slocationandusage.Tormaybeusedbythreatactorsasanalternatecommunicationpathwaytoconcealtheactor'sidentityandavoiddetection.","false_positives":["Torclientactivityisuncommoninmanagedenterprisenetworksbutmaybecommoninunmanagedorpublicnetworkswherefewsecuritypoliciesapply.Becausetheseportsareintheephemeralrange,thisrulemayfalseundercertainconditionssuchaswhenaNATedwebserverrepliestoaclientwhichhasusedoneoftheseportsbycoincidence.Inthiscase,suchserverscanbeexcludedifdesired."],"index":["filebeat-*"],"language":"kuery","name":"TorActivitytotheInternet","query":"network.transport:tcpanddestination.port:(9001or9030)andsource.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)andnotdestination.ip:(10.0.0.0/8or127.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"::1\")","risk_score":47,"rule_id":"7d2c38d7-ede7-4bdf-b140-445906e6c540","severity":"medium","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1043","name":"CommonlyUsedPort","reference":"https://attack.mitre.org/techniques/T1043/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1188","name":"Multi-hopProxy","reference":"https://attack.mitre.org/techniques/T1188/"}]}],"type":"query","version":3}
{"description":"ThisruledetectsnetworkeventsthatmayindicatetheuseofVNCtrafficfromtheInternet.VNCiscommonlyusedbysystemadministratorstoremotelycontrolasystemformaintenanceortousesharedresources.ItshouldalmostneverbedirectlyexposedtotheInternet,asitisfrequentlytargetedandexploitedbythreatactorsasaninitialaccessorback-doorvector.","false_positives":["VNCconnectionsmaybereceiveddirectlytoLinuxcloudserverinstancesbutsuchconnectionsareusuallymadeonlybyengineers.VNCislesscommonthanSSHorRDPbutmayberequiredbysomework-flowssuchasremoteaccessandsupportforspecializedsoftwareproductsorservers.Suchwork-flowsareusuallyknownandnotunexpected.Usagethatisunfamiliartoserverornetworkownerscanbeunexpectedandsuspicious."],"index":["filebeat-*"],"language":"kuery","name":"VNC(VirtualNetworkComputing)fromtheInternet","query":"network.transport:tcpanddestination.port>=5800anddestination.port<=5810andnotsource.ip:(10.0.0.0/8or127.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"::1\")anddestination.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)","risk_score":73,"rule_id":"5700cb81-df44-46aa-a5d7-337798f53eb8","severity":"high","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1219","name":"RemoteAccessTools","reference":"https://attack.mitre.org/techniques/T1219/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0001","name":"InitialAccess","reference":"https://attack.mitre.org/tactics/TA0001/"},"technique":[{"id":"T1190","name":"ExploitPublic-FacingApplication","reference":"https://attack.mitre.org/techniques/T1190/"}]}],"type":"query","version":3}
{"description":"ThisruledetectsnetworkeventsthatmayindicatetheuseofVNCtraffictotheInternet.VNCiscommonlyusedbysystemadministratorstoremotelycontrolasystemformaintenanceortousesharedresources.ItshouldalmostneverbedirectlyexposedtotheInternet,asitisfrequentlytargetedandexploitedbythreatactorsasaninitialaccessorback-doorvector.","false_positives":["VNCconnectionsmaybemadedirectlytoLinuxcloudserverinstancesbutsuchconnectionsareusuallymadeonlybyengineers.VNCislesscommonthanSSHorRDPbutmayberequiredbysomeworkflowssuchasremoteaccessandsupportforspecializedsoftwareproductsorservers.Suchwork-flowsareusuallyknownandnotunexpected.Usagethatisunfamiliartoserverornetworkownerscanbeunexpectedandsuspicious."],"index":["filebeat-*"],"language":"kuery","name":"VNC(VirtualNetworkComputing)totheInternet","query":"network.transport:tcpanddestination.port>=5800anddestination.port<=5810andsource.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)andnotdestination.ip:(10.0.0.0/8or127.0.0.0/8or172.16.0.0/12or192.168.0.0/16or\"::1\")","risk_score":47,"rule_id":"3ad49c61-7adc-42c1-b788-732eda2f5abf","severity":"medium","tags":["Elastic","Network"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1219","name":"RemoteAccessTools","reference":"https://attack.mitre.org/techniques/T1219/"}]}],"type":"query","version":3}
{"description":"Arequesttoawebapplicationservercontainednoidentifyinguseragentstring.","false_positives":["Somenormalapplicationsandscriptsmaycontainnouseragent.MostlegitimatewebrequestsfromtheInternetcontainauseragentstring.Requestsfromwebbrowsersalmostalwayscontainauseragentstring.Ifthesourceisunexpected,theuserunauthorized,ortherequestunusual,thesemayindicatesuspiciousormaliciousactivity."],"filters":[{"$state":{"store":"appState"},"exists":{"field":"user_agent.original"},"meta":{"disabled":false,"indexRefName":"kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index","key":"user_agent.original","negate":true,"type":"exists","value":"exists"}}],"index":["apm-*-transaction*"],"language":"kuery","name":"WebApplicationSuspiciousActivity:NoUserAgent","query":"url.path:*","references":["https://en.wikipedia.org/wiki/User_agent"],"risk_score":47,"rule_id":"43303fd4-4839-4e48-b2b2-803ab060758d","severity":"medium","tags":["APM","Elastic"],"type":"query","version":2}
{"anomaly_threshold":50,"description":"AmachinelearningjobdetectedunusuallylargenumbersofDNSqueriesforasingletop-levelDNSdomain,whichisoftenusedforDNStunneling.DNStunnelingcanbeusedforcommand-and-control,persistence,ordataexfiltrationactivity.Forexample,dnscattendstogeneratemanyDNSquestionsforatop-leveldomainasitusestheDNSprotocoltotunneldata.","false_positives":["DNSdomainsthatuselargenumbersofchilddomains,suchassoftwareorcontentdistributionnetworks,cantriggerthissignalandsuchparentdomainscanbeexcluded."],"from":"now-45m","interval":"15m","machine_learning_job_id":"packetbeat_dns_tunneling","name":"DNSTunneling","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"91f02f01-969f-4167-8f66-07827ac3bdd9","severity":"low","tags":["Elastic","ML","Packetbeat"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"AmachinelearningjobdetectedarareandunusualDNSquerythatindicatenetworkactivitywithunusualDNSdomains.Thiscanbeduetoinitialaccess,persistence,command-and-control,orexfiltrationactivity.Forexample,whenauserclicksonalinkinaphishingemailoropensamaliciousdocument,arequestmaybesenttodownloadandrunapayloadfromanuncommondomain.Whenmalwareisalreadyrunning,itmaysendrequeststoanuncommonDNSdomainthemalwareusesforcommand-and-controlcommunication.","false_positives":["Anewlyinstalledprogramoronethatrunsrarelyaspartofamonthlyorquarterlyworkflowcouldtriggerthissignal.Networkactivitythatoccursrarely,insmallquantities,cantriggerthissignal.Possibleexamplesarebrowsingtechnicalsupportorvendornetworkssparsely.Auserwhovisitsaneworuniquewebdestinationmaytriggerthissignal."],"from":"now-45m","interval":"15m","machine_learning_job_id":"packetbeat_rare_dns_question","name":"UnusualDNSActivity","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"746edc4c-c54c-49c6-97a1-651223819448","severity":"low","tags":["Elastic","ML","Packetbeat"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"Amachinelearningjobdetectedanunusualnetworkdestinationdomainname.Thiscanbeduetoinitialaccess,persistence,command-and-control,orexfiltrationactivity.Forexample,whenauserclicksonalinkinaphishingemailoropensamaliciousdocument,arequestmaybesenttodownloadandrunapayloadfromanuncommonwebservername.Whenmalwareisalreadyrunning,itmaysendrequeststoanuncommonDNSdomainthemalwareusesforcommand-and-controlcommunication.","false_positives":["Webactivitythatoccursrarelyinsmallquantitiescantriggerthissignal.PossibleexamplesarebrowsingtechnicalsupportorvendorURLsthatareusedverysparsely.Auserwhovisitsanewanduniquewebdestinationmaytriggerthissignalwhentheactivityissparse.WebapplicationsthatgenerateURLsuniquetoatransactionmaytriggerthiswhentheyareusedsparsely.Webdomainscanbeexcludedincasessuchasthese."],"from":"now-45m","interval":"15m","machine_learning_job_id":"packetbeat_rare_server_domain","name":"UnusualNetworkDestinationDomainName","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"17e68559-b274-4948-ad0b-f8415bb31126","severity":"low","tags":["Elastic","ML","Packetbeat"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"AmachinelearningjobdetectedarareandunusualURLthatindicatesunusualwebbrowsingactivity.Thiscanbeduetoinitialaccess,persistence,command-and-control,orexfiltrationactivity.Forexample,inastrategicwebcompromiseorwateringholeattack,whenatrustedwebsiteiscompromisedtotargetaparticularsectorororganization,targetedusersmayreceiveemailswithuncommonURLsfortrustedwebsites.TheseURLscanbeusedtodownloadandrunapayload.Whenmalwareisalreadyrunning,itmaysendrequeststouncommonURLsontrustedwebsitesthemalwareusesforcommand-and-controlcommunication.WhenrareURLsareobservedbeingrequestedforalocalwebserverbyaremotesource,thesecanbeduetowebscanning,enumerationorattacktraffic,ortheycanbeduetobotsandwebscraperswhicharepartofcommonInternetbackgroundtraffic.","false_positives":["Webactivitythatoccursrarelyinsmallquantitiescantriggerthissignal.PossibleexamplesarebrowsingtechnicalsupportorvendorURLsthatareusedverysparsely.Auserwhovisitsanewanduniquewebdestinationmaytriggerthissignalwhentheactivityissparse.WebapplicationsthatgenerateURLsuniquetoatransactionmaytriggerthiswhentheyareusedsparsely.Webdomainscanbeexcludedincasessuchasthese."],"from":"now-45m","interval":"15m","machine_learning_job_id":"packetbeat_rare_urls","name":"UnusualWebRequest","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"91f02f01-969f-4167-8f55-07827ac3acc9","severity":"low","tags":["Elastic","ML","Packetbeat"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"Amachinelearningjobdetectedarareandunusualuseragentindicatingwebbrowsingactivitybyanunusualprocessotherthanawebbrowser.Thiscanbeduetopersistence,command-and-control,orexfiltrationactivity.Uncommonuseragentscomingfromremotesourcestolocaldestinationsareoftentheresultofscanners,bots,andwebscrapers,whicharepartofcommonInternetbackgroundtraffic.Muchofthisisnoise,butmoretargetedattacksonwebsitesusingtoolslikeBurporSQLmapcansometimesbediscoveredbyspottinguncommonuseragents.Uncommonuseragentsintrafficfromlocalsourcestoremotedestinationscanbeanynumberofthings,includingharmlessprogramslikeweathermonitoringorstock-tradingprograms.However,uncommonuseragentsfromlocalsourcescanalsobeduetomalwareorscanningactivity.","false_positives":["Webactivitythatisuncommon,likesecurityscans,maytriggerthissignalandmayneedtobeexcluded.Aneworrarelyusedprogramthatcallswebservicesmaytriggerthissignal."],"from":"now-45m","interval":"15m","machine_learning_job_id":"packetbeat_rare_user_agent","name":"UnusualWebUserAgent","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"91f02f01-969f-4167-8d77-07827ac4cee0","severity":"low","tags":["Elastic","ML","Packetbeat"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"Identifiesrareprocessesthatdonotusuallyrunonindividualhosts,whichcanindicateexecutionofunauthorizedservices,malware,orpersistencemechanisms.Processesareconsideredrarewhentheyonlyrunoccasionallyascomparedwithotherprocessesrunningonthehost.","false_positives":["Anewlyinstalledprogramoronethatrunsrarelyaspartofamonthlyorquarterlyworkflowcouldtriggerthissignal."],"from":"now-45m","interval":"15m","machine_learning_job_id":"rare_process_by_host_linux_ecs","name":"UnusualProcessForaLinuxHost","note":"###InvestigatinganUnusualLinuxProcess###\nSignalsfromthisruleindicatethepresenceofaLinuxprocessthatisrareandunusualforthehostitranon.Herearesomepossibleavenuesofinvestigation:\n-Considertheuserasidentifiedbytheusernamefield.Isthisprogrampartofanexpectedworkflowfortheuserwhoranthisprogramonthishost?\n-Examinethehistoryofexecution.Ifthisprocessmanifestedonlyveryrecently,itmightbepartofanewsoftwarepackage.Ifithasaconsistentcadence-forexampleifitrunsmonthlyorquarterly-itmightbepartofamonthlyorquarterlybusinessprocess.\n-Examinetheprocessarguments,titleandworkingdirectory.Thesemayprovideindicationsastothesourceoftheprogramorthenatureofthetasksitisperforming.","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"46f804f5-b289-43d6-a881-9387cf594f75","severity":"low","tags":["Elastic","Linux","ML"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"Identifiesrareprocessesthatdonotusuallyrunonindividualhosts,whichcanindicateexecutionofunauthorizedservices,malware,orpersistencemechanisms.Processesareconsideredrarewhentheyonlyrunoccasionallyascomparedwithotherprocessesrunningonthehost.","false_positives":["Anewlyinstalledprogramoronethatrunsrarelyaspartofamonthlyorquarterlyworkflowcouldtriggerthissignal."],"from":"now-45m","interval":"15m","machine_learning_job_id":"rare_process_by_host_windows_ecs","name":"UnusualProcessForaWindowsHost","note":"###InvestigatinganUnusualWindowsProcess###\nSignalsfromthisruleindicatethepresenceofaWindowsprocessthatisrareandunusualforthehostitranon.Herearesomepossibleavenuesofinvestigation:\n-Considertheuserasidentifiedbytheusernamefield.Isthisprogrampartofanexpectedworkflowfortheuserwhoranthisprogramonthishost?\n-Examinethehistoryofexecution.Ifthisprocessmanifestedonlyveryrecently,itmightbepartofanewsoftwarepackage.Ifithasaconsistentcadence-forexampleifitrunsmonthlyorquarterly-itmightbepartofamonthlyorquarterlybusinessprocess.\n-ExaminetheprocessmetadatalikethevaluesoftheCompany,DescriptionandProductfieldswhichmayindicatewhethertheprogramisassociatedwithanexpectedsoftwarevendororpackage.\n-Examineargumentsandworkingdirectory.Thesemayprovideindicationsastothesourceoftheprogramorthenatureofthetasksitisperforming.\n-Considerthesamefortheparentprocess.Iftheparentprocessisalegitimatesystemutilityorservice,thiscouldberelatedtosoftwareupdatesorsystemmanagement.Iftheparentprocessissomethinguser-facinglikeanOfficeapplication,thisprocesscouldbemoresuspicious.\n-Ifyouhavefilehashvaluesintheeventdata,andyoususpectmalware,youcanoptionallyrunasearchforthefilehashtoseeifthefileisidentifiedasmalwarebyanti-malwaretools.","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"6d448b96-c922-4adb-b51c-b767f1ea5b76","severity":"low","tags":["Elastic","ML","Windows"],"type":"machine_learning","version":1}
{"description":"Thisisanexampleofhowtodetectanunwantedwebclientuseragent.Thissearchmatchestheuseragentforsqlmap1.3.11,whichisapopularFOSStoolfortestingwebapplicationsforSQLinjectionvulnerabilities.","false_positives":["ThisruledoesnotindicatethataSQLinjectionattackoccurred,onlythatthe`sqlmap`toolwasused.Securityscansandtestsmayresultintheseerrors.Ifthesourceisnotanauthorizedsecuritytester,thisisgenerallysuspiciousormaliciousactivity."],"index":["apm-*-transaction*"],"language":"kuery","name":"WebApplicationSuspiciousActivity:sqlmapUserAgent","query":"user_agent.original:\"sqlmap/1.3.11#stable(http://sqlmap.org)\"","references":["http://sqlmap.org/"],"risk_score":47,"rule_id":"d49cc73f-7a16-4def-89ce-9fc7127d7820","severity":"medium","tags":["APM","Elastic"],"type":"query","version":2}
{"anomaly_threshold":50,"description":"Identifiesanunusuallyhighnumberofauthenticationattempts.","false_positives":["Securityauditsmaytriggerthissignal.Conditionsthatgenerateburstsoffailedlogins,suchasmisconfiguredapplicationsoraccountlockoutscouldtriggerthissignal."],"from":"now-45m","interval":"15m","machine_learning_job_id":"suspicious_login_activity_ecs","name":"UnusualLoginActivity","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"4330272b-9724-4bc6-a3ca-f1532b81e5c2","severity":"low","tags":["Elastic","Linux","ML"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"IdentifiesWindowsprocessesthatdonotusuallyusethenetworkbuthaveunexpectednetworkactivity,whichcanindicatecommand-and-control,lateralmovement,persistence,ordataexfiltrationactivity.Aprocesswithunusualnetworkactivitycandenoteprocessexploitationorinjection,wheretheprocessisusedtorunpersistencemechanismsthatallowamaliciousactorremoteaccessorcontrolofthehost,dataexfiltration,andexecutionofunauthorizednetworkapplications.","false_positives":["Anewlyinstalledprogramoronethatrarelyusesthenetworkcouldtriggerthissignal."],"from":"now-45m","interval":"15m","machine_learning_job_id":"windows_anomalous_network_activity_ecs","name":"UnusualWindowsNetworkActivity","note":"###InvestigatingUnusualNetworkActivity###\nSignalsfromthisruleindicatethepresenceofnetworkactivityfromaWindowsprocessforwhichnetworkactivityisveryunusual.Herearesomepossibleavenuesofinvestigation:\n-ConsidertheIPaddresses,protocolandports.Aretheseusedbynormalbutinfrequentnetworkworkflows?Aretheyexpectedorunexpected?\n-IfthedestinationIPaddressisremoteorexternal,doesitassociatewithanexpecteddomain,organizationorgeography?Note:avoidinteractingdirectlywithsuspectedmaliciousIPaddresses.\n-Considertheuserasidentifiedbytheusernamefield.Isthisnetworkactivitypartofanexpectedworkflowfortheuserwhorantheprogram?\n-Examinethehistoryofexecution.Ifthisprocessmanifestedonlyveryrecently,itmightbepartofanewsoftwarepackage.Ifithasaconsistentcadence-forexampleifitrunsmonthlyorquarterly-itmightbepartofamonthlyorquarterlybusinessprocess.\n-Examinetheprocessarguments,titleandworkingdirectory.Thesemayprovideindicationsastothesourceoftheprogramorthenatureofthetasksitisperforming.\n-Considerthesamefortheparentprocess.Iftheparentprocessisalegitimatesystemutilityorservice,thiscouldberelatedtosoftwareupdatesorsystemmanagement.Iftheparentprocessissomethinguser-facinglikeanOfficeapplication,thisprocesscouldbemoresuspicious.\n-Ifyouhavefilehashvaluesintheeventdata,andyoususpectmalware,youcanoptionallyrunasearchforthefilehashtoseeifthefileisidentifiedasmalwarebyanti-malwaretools.","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"ba342eb2-583c-439f-b04d-1fdd7c1417cc","severity":"low","tags":["Elastic","ML","Windows"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"Identifiesprocessesstartedfromatypicalfoldersinthefilesystem,whichmightindicatemalwareexecutionorpersistencemechanisms.IncorporateWindowsenvironments,softwareinstallationiscentrallymanagedanditisunusualforprogramstobeexecutedfromuserortemporarydirectories.ProcessesexecutedfromtheselocationscandenotethatauserdownloadedsoftwaredirectlyfromtheInternetoramaliciousscriptormacroexecutedmalware.","false_positives":["Anewandunusualprogramorartifactdownloadinthecourseofsoftwareupgrades,debugging,ortroubleshootingcouldtriggerthissignal.Usersdownloadingandrunningprogramsfromunusuallocations,suchastemporarydirectories,browsercaches,orprofilepathscouldtriggerthissignal."],"from":"now-45m","interval":"15m","machine_learning_job_id":"windows_anomalous_path_activity_ecs","name":"UnusualWindowsPathActivity","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"445a342e-03fb-42d0-8656-0367eb2dead5","severity":"low","tags":["Elastic","ML","Windows"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"Searchesforrareprocessesrunningonmultiplehostsinanentirefleetornetwork.Thisreducesthedetectionoffalsepositivessinceautomatedmaintenanceprocessesusuallyonlyrunoccasionallyonasinglemachinebutarecommontoallormanyhostsinafleet.","false_positives":["Anewlyinstalledprogramoronethatrunsrarelyaspartofamonthlyorquarterlyworkflowcouldtriggerthissignal."],"from":"now-45m","interval":"15m","machine_learning_job_id":"windows_anomalous_process_all_hosts_ecs","name":"AnomalousProcessForaWindowsPopulation","note":"###InvestigatinganUnusualWindowsProcess###\nSignalsfromthisruleindicatethepresenceofaWindowsprocessthatisrareandunusualforalloftheWindowshostsforwhichWinlogbeatdataisavailable.Herearesomepossibleavenuesofinvestigation:\n-Considertheuserasidentifiedbytheusernamefield.Isthisprogrampartofanexpectedworkflowfortheuserwhoranthisprogramonthishost?\n-Examinethehistoryofexecution.Ifthisprocessmanifestedonlyveryrecently,itmightbepartofanewsoftwarepackage.Ifithasaconsistentcadence-forexampleifitrunsmonthlyorquarterly-itmightbepartofamonthlyorquarterlybusinessprocess.\n-ExaminetheprocessmetadatalikethevaluesoftheCompany,DescriptionandProductfieldswhichmayindicatewhethertheprogramisassociatedwithanexpectedsoftwarevendororpackage.\n-Examineargumentsandworkingdirectory.Thesemayprovideindicationsastothesourceoftheprogramorthenatureofthetasksitisperforming.\n-Considerthesamefortheparentprocess.Iftheparentprocessisalegitimatesystemutilityorservice,thiscouldberelatedtosoftwareupdatesorsystemmanagement.Iftheparentprocessissomethinguser-facinglikeanOfficeapplication,thisprocesscouldbemoresuspicious.\n-Ifyouhavefilehashvaluesintheeventdata,andyoususpectmalware,youcanoptionallyrunasearchforthefilehashtoseeifthefileisidentifiedasmalwarebyanti-malwaretools.","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"6e40d56f-5c0e-4ac6-aece-bee96645b172","severity":"low","tags":["Elastic","ML","Windows"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"Identifiesunusualparent-childprocessrelationshipsthatcanindicatemalwareexecutionorpersistencemechanisms.Maliciousscriptsoftencallonotherapplicationsandprocessesaspartoftheirexploitpayload.Forexample,whenamaliciousOfficedocumentrunsscriptsaspartofanexploitpayload,ExcelorWordmaystartascriptinterpreterprocess,which,inturn,runsascriptthatdownloadsandexecutesmalware.AnothercommonscenarioisOutlookrunninganunusualprocesswhenmalwareisdownloadedinanemail.Monitoringandidentifyinganomalousprocessrelationshipsisamethodofdetectingnewandemergingmalwarethatisnotyetrecognizedbyanti-virusscanners.","false_positives":["Usersrunningscriptsinthecourseoftechnicalsupportoperationsofsoftwareupgradescouldtriggerthissignal.Anewlyinstalledprogramoronethatrunsrarelyaspartofamonthlyorquarterlyworkflowcouldtriggerthissignal."],"from":"now-45m","interval":"15m","machine_learning_job_id":"windows_anomalous_process_creation","name":"AnomalousWindowsProcessCreation","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"0b29cab4-dbbd-4a3f-9e8e-1287c7c11ae5","severity":"low","tags":["Elastic","ML","Windows"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"AmachinelearningjobdetectedaPowerShellscriptwithunusualdatacharacteristics,suchasobfuscation,thatmaybeacharacteristicofmaliciousPowerShellscripttextblocks.","false_positives":["Certainkindsofsecuritytestingmaytriggerthissignal.PowerShellscriptsthatusehighlevelsofobfuscationorhaveunusualscriptblockpayloadsmaytriggerthissignal."],"from":"now-45m","interval":"15m","machine_learning_job_id":"windows_anomalous_script","name":"SuspiciousPowershellScript","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"1781d055-5c66-4adf-9d60-fc0fa58337b6","severity":"low","tags":["Elastic","ML","Windows"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"AmachinelearningjobdetectedanunusualWindowsservice,Thiscanindicateexecutionofunauthorizedservices,malware,orpersistencemechanisms.IncorporateWindowsenvironments,hostsdonotgenerallyrunmanyrareoruniqueservices.Thisjobhelpsdetectmalwareandpersistencemechanismsthathavebeeninstalledandrunasaservice.","false_positives":["Anewlyinstalledprogramoronethatrunsrarelyaspartofamonthlyorquarterlyworkflowcouldtriggerthissignal."],"from":"now-45m","interval":"15m","machine_learning_job_id":"windows_anomalous_service","name":"UnusualWindowsService","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"1781d055-5c66-4adf-9c71-fc0fa58338c7","severity":"low","tags":["Elastic","ML","Windows"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"Amachinelearningjobdetectedactivityforausernamethatisnotnormallyactive,whichcanindicateunauthorizedchanges,activitybyunauthorizedusers,lateralmovement,orcompromisedcredentials.Inmanyorganizations,newusernamesarenotoftencreatedapartfromspecifictypesofsystemactivities,suchascreatingnewaccountsfornewemployees.Theseuseraccountsquicklybecomeactiveandroutine.Eventsfromrarelyusedusernamescanpointtosuspiciousactivity.Additionally,automatedLinuxfleetstendtoseeactivityfromrarelyusedusernamesonlywhenpersonnellogintomakeauthorizedorunauthorizedchanges,orthreatactorshaveacquiredcredentialsandloginformaliciouspurposes.Unusualusernamescanalsoindicatepivoting,wherecompromisedcredentialsareusedtotryandmovelaterallyfromonehosttoanother.","false_positives":["Uncommonuseractivitycanbeduetoanadministratororhelpdesktechnicianloggingontoaworkstationorserverinordertoperformmanualtroubleshootingorreconfiguration."],"from":"now-45m","interval":"15m","machine_learning_job_id":"windows_anomalous_user_name_ecs","name":"UnusualWindowsUsername","note":"###InvestigatinganUnusualWindowsUser###\nSignalsfromthisruleindicateactivityforaWindowsusernamethatisrareandunusual.Herearesomepossibleavenuesofinvestigation:\n-Considertheuserasidentifiedbytheusernamefield.Isthisprogrampartofanexpectedworkflowfortheuserwhoranthisprogramonthishost?Couldthisberelatedtooccasionaltroubleshootingorsupportactivity?\n-Examinethehistoryofuseractivity.Ifthisusermanifestedonlyveryrecently,itmightbeaserviceaccountforanewsoftwarepackage.Ifithasaconsistentcadence-forexampleifitrunsmonthlyorquarterly-itmightbepartofamonthlyorquarterlybusinessprocess.\n-Examinetheprocessarguments,titleandworkingdirectory.Thesemayprovideindicationsastothesourceoftheprogramorthenatureofthetasksthattheuserisperforming.\n-Considerthesamefortheparentprocess.Iftheparentprocessisalegitimatesystemutilityorservice,thiscouldberelatedtosoftwareupdatesorsystemmanagement.Iftheparentprocessissomethinguser-facinglikeanOfficeapplication,thisprocesscouldbemoresuspicious.","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"1781d055-5c66-4adf-9c59-fc0fa58336a5","severity":"low","tags":["Elastic","ML","Windows"],"type":"machine_learning","version":1}
{"description":"Identifiescertutil.exemakinganetworkconnection.Adversariescouldabusecertutil.exetodownloadacertificate,ormalware,fromaremoteURL.","index":["winlogbeat-*"],"language":"kuery","name":"NetworkConnectionviaCertutil","query":"process.name:certutil.exeandevent.action:\"Networkconnectiondetected(rule:NetworkConnect)\"andnotdestination.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)","risk_score":21,"rule_id":"3838e0e3-1850-4850-a411-2e8c5ba40ba8","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1105","name":"RemoteFileCopy","reference":"https://attack.mitre.org/techniques/T1105/"}]}],"type":"query","version":1}
{"description":"Identifiescmd.exemakinganetworkconnection.Adversariescouldabusecmd.exetodownloadorexecutemalwarefromaremoteURL.","false_positives":["Administratorsmayusethecommandpromptforregularadministrativetasks.It'simportanttobaselineyourenvironmentfornetworkconnectionsbeingmadefromthecommandprompttodetermineanyabnormaluseofthistool."],"index":["winlogbeat-*"],"language":"kuery","name":"CommandPromptNetworkConnection","query":"process.name:cmd.exeandevent.action:\"Networkconnectiondetected(rule:NetworkConnect)\"andnotdestination.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)","risk_score":21,"rule_id":"89f9a4b0-9f8f-4ee0-8823-c4751a6d6696","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1059","name":"Command-LineInterface","reference":"https://attack.mitre.org/techniques/T1059/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0011","name":"CommandandControl","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1105","name":"RemoteFileCopy","reference":"https://attack.mitre.org/techniques/T1105/"}]}],"type":"query","version":2}
{"description":"Identifiesasuspiciousparentchildprocessrelationshipwithcmd.exedescendingfromPowerShell.exe.","index":["winlogbeat-*"],"language":"kuery","name":"PowerShellspawningCmd","query":"process.parent.name:powershell.exeandprocess.name:cmd.exe","risk_score":21,"rule_id":"0f616aee-8161-4120-857e-742366f5eeb3","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1059","name":"Command-LineInterface","reference":"https://attack.mitre.org/techniques/T1059/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1086","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1086/"}]}],"type":"query","version":2}
{"description":"Identifiesasuspiciousparentchildprocessrelationshipwithcmd.exedescendingfromsvchost.exe","index":["winlogbeat-*"],"language":"kuery","name":"SvchostspawningCmd","query":"process.parent.name:svchost.exeandprocess.name:cmd.exe","risk_score":21,"rule_id":"fd7a6052-58fa-4397-93c3-4795249ccfa2","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1059","name":"Command-LineInterface","reference":"https://attack.mitre.org/techniques/T1059/"}]}],"type":"query","version":2}
{"description":"AninstanceofMSBuild,theMicrosoftBuildEngine,loadedDLLs(dynamicallylinkedlibraries)responsibleforWindowscredentialmanagement.Thistechniqueissometimesusedforcredentialdumping.","false_positives":["TheBuildEngineiscommonlyusedbyWindowsdevelopersbutusebynon-engineersisunusual."],"index":["winlogbeat-*"],"language":"kuery","name":"MicrosoftBuildEngineLoadingWindowsCredentialLibraries","query":"(winlog.event_data.OriginalFileName:(vaultcli.dllorSAMLib.DLL)ordll.name:(vaultcli.dllorSAMLib.DLL))andprocess.name:MSBuild.exeandevent.action:\"Imageloaded(rule:ImageLoad)\"","risk_score":73,"rule_id":"9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae5","severity":"high","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0006","name":"CredentialAccess","reference":"https://attack.mitre.org/tactics/TA0006/"},"technique":[{"id":"T1003","name":"CredentialDumping","reference":"https://attack.mitre.org/techniques/T1003/"}]}],"type":"query","version":1}
{"description":"AspoofingvulnerabilityexistsinthewayWindowsCryptoAPI(Crypt32.dll)validatesEllipticCurveCryptography(ECC)certificates.Anattackercouldexploitthevulnerabilitybyusingaspoofedcode-signingcertificatetosignamaliciousexecutable,makingitappearthefilewasfromatrusted,legitimatesource.","index":["winlogbeat-*"],"language":"kuery","name":"WindowsCryptoAPISpoofingVulnerability(CVE-2020-0601-CurveBall)","query":"event.provider:\"Microsoft-Windows-Audit-CVE\"andmessage:\"[CVE-2020-0601]\"","risk_score":21,"rule_id":"56557cde-d923-4b88-adee-c61b3f3b5dc3","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1116","name":"CodeSigning","reference":"https://attack.mitre.org/techniques/T1116/"}]}],"type":"query","version":1}
{"description":"TheFilterManagerControlProgram(fltMC.exe)binarymaybeabusedbyadversariestounloadafilterdriverandevadedefenses.","index":["winlogbeat-*"],"language":"kuery","name":"PotentialEvasionviaFilterManager","query":"event.code:1andprocess.name:fltMC.exe","risk_score":21,"rule_id":"06dceabf-adca-48af-ac79-ffdf4c3b1e9a","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1222","name":"FileandDirectoryPermissionsModification","reference":"https://attack.mitre.org/techniques/T1222/"}]}],"type":"query","version":2}
{"description":"AninstanceofMSBuild,theMicrosoftBuildEngine,wasstartedbyExcelorWord.ThisisunusualbehaviorfortheBuildEngineandcouldhavebeencausedbyanExcelorWorddocumentexecutingamaliciousscriptpayload.","false_positives":["TheBuildEngineiscommonlyusedbyWindowsdevelopersbutusebynon-engineersisunusual.ItisquiteunusualforthisprogramtobestartedbyanOfficeapplicationlikeWordorExcel."],"index":["winlogbeat-*"],"language":"kuery","name":"MicrosoftBuildEngineStartedbyanOfficeApplication","query":"process.name:MSBuild.exeandprocess.parent.name:(eqnedt32.exeorexcel.exeorfltldr.exeormsaccess.exeormspub.exeoroutlook.exeorpowerpnt.exeorwinword.exe)andevent.action:\"ProcessCreate(rule:ProcessCreate)\"","references":["https://blog.talosintelligence.com/2020/02/building-bypass-with-msbuild.html"],"risk_score":73,"rule_id":"c5dc3223-13a2-44a2-946c-e9dc0aa0449c","severity":"high","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1127","name":"TrustedDeveloperUtilities","reference":"https://attack.mitre.org/techniques/T1127/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1127","name":"TrustedDeveloperUtilities","reference":"https://attack.mitre.org/techniques/T1127/"}]}],"type":"query","version":1}
{"description":"AninstanceofMSBuild,theMicrosoftBuildEngine,wasstartedbyascriptortheWindowscommandinterpreter.Thisbehaviorisunusualandissometimesusedbymaliciouspayloads.","false_positives":["TheBuildEngineiscommonlyusedbyWindowsdevelopersbutusebynon-engineersisunusual."],"index":["winlogbeat-*"],"language":"kuery","name":"MicrosoftBuildEngineStartedbyaScriptProcess","query":"process.name:MSBuild.exeandprocess.parent.name:(cmd.exeorpowershell.exeorcscript.exeorwscript.exe)andevent.action:\"ProcessCreate(rule:ProcessCreate)\"","risk_score":21,"rule_id":"9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae2","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1127","name":"TrustedDeveloperUtilities","reference":"https://attack.mitre.org/techniques/T1127/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1127","name":"TrustedDeveloperUtilities","reference":"https://attack.mitre.org/techniques/T1127/"}]}],"type":"query","version":1}
{"description":"AninstanceofMSBuild,theMicrosoftBuildEngine,wasstartedbyExplorerortheWMI(WindowsManagementInstrumentation)subsystem.Thisbehaviorisunusualandissometimesusedbymaliciouspayloads.","false_positives":["TheBuildEngineiscommonlyusedbyWindowsdevelopersbutusebynon-engineersisunusual."],"index":["winlogbeat-*"],"language":"kuery","name":"MicrosoftBuildEngineStartedbyaSystemProcess","query":"process.name:MSBuild.exeandprocess.parent.name:(explorer.exeorwmiprvse.exe)andevent.action:\"ProcessCreate(rule:ProcessCreate)\"","risk_score":47,"rule_id":"9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae3","severity":"medium","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1127","name":"TrustedDeveloperUtilities","reference":"https://attack.mitre.org/techniques/T1127/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1127","name":"TrustedDeveloperUtilities","reference":"https://attack.mitre.org/techniques/T1127/"}]}],"type":"query","version":1}
{"description":"AninstanceofMSBuild,theMicrosoftBuildEngine,wasstartedafterbeingrenamed.Thisisuncommonbehaviorandmayindicateanattempttorununnoticedorundetected.","false_positives":["TheBuildEngineiscommonlyusedbyWindowsdevelopersbutusebynon-engineersisunusual."],"index":["winlogbeat-*"],"language":"kuery","name":"MicrosoftBuildEngineUsinganAlternateName","query":"(pe.original_file_name:MSBuild.exeorwinlog.event_data.OriginalFileName:MSBuild.exe)andnotprocess.name:MSBuild.exeandevent.action:\"ProcessCreate(rule:ProcessCreate)\"","risk_score":21,"rule_id":"9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae4","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1036","name":"Masquerading","reference":"https://attack.mitre.org/techniques/T1036/"}]}],"type":"query","version":1}
{"description":"AninstanceofMSBuild,theMicrosoftBuildEngine,startedaPowerShellscriptortheVisualC#CommandLineCompiler.ThistechniqueissometimesusedtodeployamaliciouspayloadusingtheBuildEngine.","false_positives":["TheBuildEngineiscommonlyusedbyWindowsdevelopersbutusebynon-engineersisunusual.Ifabuildsystemtriggersthisruleitcanbeexemptedbyprocess,userorhostname."],"index":["winlogbeat-*"],"language":"kuery","name":"MicrosoftBuildEngineStartedanUnusualProcess","query":"process.parent.name:MSBuild.exeandprocess.name:(csc.exeoriexplore.exeorpowershell.exe)","references":["https://blog.talosintelligence.com/2020/02/building-bypass-with-msbuild.html"],"risk_score":21,"rule_id":"9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae6","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1500","name":"CompileAfterDelivery","reference":"https://attack.mitre.org/techniques/T1500/"}]}],"type":"query","version":1}
{"description":"CompiledHTMLfiles(.chm)arecommonlydistributedaspartoftheMicrosoftHTMLHelpsystem.AdversariesmayconcealmaliciouscodeinaCHMfileanddeliverittoavictimforexecution.CHMcontentisloadedbytheHTMLHelpexecutableprogram(hh.exe).","false_positives":["TheHTMLHelpexecutableprogram(hh.exe)runswheneverauserclicksacompiledhelp(.chm)fileormenuitemthatopensthehelpfileinsidetheHelpViewer.Thisisnotalwaysmalicious,butadversariesmayabusethistechnologytoconcealmaliciouscode."],"index":["winlogbeat-*"],"language":"kuery","name":"ProcessActivityviaCompiledHTMLFile","query":"event.code:1andprocess.name:hh.exe","risk_score":21,"rule_id":"e3343ab9-4245-4715-b344-e11c56b0a47f","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1223","name":"CompiledHTMLFile","reference":"https://attack.mitre.org/techniques/T1223/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1223","name":"CompiledHTMLFile","reference":"https://attack.mitre.org/techniques/T1223/"}]}],"type":"query","version":2}
{"description":"RegSvcs.exeandRegAsm.exeareWindowscommandlineutilitiesthatareusedtoregister.NETComponentObjectModel(COM)assemblies.AdversariescanuseRegSvcs.exeandRegAsm.exetoproxyexecutionofcodethroughatrustedWindowsutility.","index":["winlogbeat-*"],"language":"kuery","name":"ExecutionviaRegsvcs/Regasm","query":"process.name:(RegAsm.exeorRegSvcs.exe)andevent.action:\"ProcessCreate(rule:ProcessCreate)\"","risk_score":21,"rule_id":"47f09343-8d1f-4bb5-8bb0-00c9d18f5010","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1121","name":"Regsvcs/Regasm","reference":"https://attack.mitre.org/techniques/T1121/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1121","name":"Regsvcs/Regasm","reference":"https://attack.mitre.org/techniques/T1121/"}]}],"type":"query","version":1}
{"description":"IdentifiespossiblysuspiciousactivityusingtrustedWindowsdeveloperactivity.","false_positives":["TheseprogramsmaybeusedbyWindowsdevelopersbutusebynon-engineersisunusual."],"index":["winlogbeat-*"],"language":"kuery","name":"TrustedDeveloperApplicationUsage","query":"event.code:1andprocess.name:(MSBuild.exeormsxsl.exe)","risk_score":21,"rule_id":"9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae1","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1127","name":"TrustedDeveloperUtilities","reference":"https://attack.mitre.org/techniques/T1127/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1127","name":"TrustedDeveloperUtilities","reference":"https://attack.mitre.org/techniques/T1127/"}]}],"type":"query","version":2}
{"description":"CompiledHTMLfiles(.chm)arecommonlydistributedaspartoftheMicrosoftHTMLHelpsystem.AdversariesmayconcealmaliciouscodeinaCHMfileanddeliverittoavictimforexecution.CHMcontentisloadedbytheHTMLHelpexecutableprogram(hh.exe).","index":["winlogbeat-*"],"language":"kuery","name":"NetworkConnectionviaCompiledHTMLFile","query":"process.name:hh.exeandevent.action:\"Networkconnectiondetected(rule:NetworkConnect)\"andnotdestination.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)","risk_score":21,"rule_id":"b29ee2be-bf99-446c-ab1a-2dc0183394b8","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1223","name":"CompiledHTMLFile","reference":"https://attack.mitre.org/techniques/T1223/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1223","name":"CompiledHTMLFile","reference":"https://attack.mitre.org/techniques/T1223/"}]}],"type":"query","version":2}
{"description":"AninstanceofMSBuild,theMicrosoftBuildEngine,createdathreadinanotherprocess.Thistechniqueissometimesusedtoevadedetectionorelevateprivileges.","false_positives":["TheBuildEngineiscommonlyusedbyWindowsdevelopersbutusebynon-engineersisunusual."],"index":["winlogbeat-*"],"language":"kuery","name":"ProcessInjectionbytheMicrosoftBuildEngine","query":"process.name:MSBuild.exeandevent.action:\"CreateRemoteThreaddetected(rule:CreateRemoteThread)\"","risk_score":21,"rule_id":"9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae9","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1055","name":"ProcessInjection","reference":"https://attack.mitre.org/techniques/T1055/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0004","name":"PrivilegeEscalation","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1055","name":"ProcessInjection","reference":"https://attack.mitre.org/techniques/T1055/"}]}],"type":"query","version":1}
{"description":"BinariessignedwithtrusteddigitalcertificatescanexecuteonWindowssystemsprotectedbydigitalsignaturevalidation.Adversariesmayusethesebinariesto'liveofftheland'andexecutemaliciousfilesthatcouldbypassapplicationwhitelistingandsignaturevalidation.","index":["winlogbeat-*"],"language":"kuery","name":"NetworkConnectionviaSignedBinary","query":"process.name:(expand.exeorextrac.exeorieexec.exeormakecab.exe)andevent.action:\"Networkconnectiondetected(rule:NetworkConnect)\"andnotdestination.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)","risk_score":21,"rule_id":"63e65ec3-43b1-45b0-8f2d-45b34291dc44","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1218","name":"SignedBinaryProxyExecution","reference":"https://attack.mitre.org/techniques/T1218/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1218","name":"SignedBinaryProxyExecution","reference":"https://attack.mitre.org/techniques/T1218/"}]}],"type":"query","version":2}
{"description":"Identifiesuseofbcdedit.exetodeletebootconfigurationdata.Thistacticissometimesusedasbymalwareoranattackerasadestructivetechnique.","index":["winlogbeat-*"],"language":"kuery","name":"ModificationofBootConfiguration","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.name:bcdedit.exeandprocess.args:(/setand(bootstatuspolicyandignoreallfailuresornoandrecoveryenabled))","risk_score":21,"rule_id":"69c251fb-a5d6-4035-b5ec-40438bd829ff","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1107","name":"FileDeletion","reference":"https://attack.mitre.org/techniques/T1107/"}]}],"type":"query","version":1}
{"description":"Identifiesmsxsl.exemakinganetworkconnection.Thismayindicateadversarialactivityasmsxsl.exeisoftenleveragedbyadversariestoexecutemaliciousscriptsandevadedetection.","index":["winlogbeat-*"],"language":"kuery","name":"NetworkConnectionviaMsXsl","query":"process.name:msxsl.exeandevent.action:\"Networkconnectiondetected(rule:NetworkConnect)\"andnotdestination.ip:(10.0.0.0/8or172.16.0.0/12or192.168.0.0/16)","risk_score":21,"rule_id":"b86afe07-0d98-4738-b15d-8d7465f95ff5","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1220","name":"XSLScriptProcessing","reference":"https://attack.mitre.org/techniques/T1220/"}]}],"type":"query","version":1}
{"description":"IdentifiestheSYSTEMaccountusingtheNetutility.TheNetutilityisacomponentoftheWindowsoperatingsystem.Itisusedincommandlineoperationsforcontrolofusers,groups,services,andnetworkconnections.","index":["winlogbeat-*"],"language":"kuery","name":"NetcommandviaSYSTEMaccount","query":"(process.name:net.exeorprocess.name:net1.exeandnotprocess.parent.name:net.exe)anduser.name:SYSTEMandevent.action:\"ProcessCreate(rule:ProcessCreate)\"","risk_score":21,"rule_id":"2856446a-34e6-435b-9fb5-f8f040bfa7ed","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1087","name":"AccountDiscovery","reference":"https://attack.mitre.org/techniques/T1087/"}]}],"type":"query","version":1}
{"description":"TheApplicationShimwascreatedtoallowforbackwardcompatibilityofsoftwareastheoperatingsystemcodebasechangesovertime.ThisWindowsfunctionalityhasbeenabusedbyattackerstostealthilygainpersistenceandarbitrarycodeexecutioninlegitimateWindowsprocesses.","index":["winlogbeat-*"],"language":"kuery","name":"PotentialApplicationShimmingviaSdbinst","query":"event.code:1andprocess.name:sdbinst.exe","risk_score":21,"rule_id":"fd4a992d-6130-4802-9ff8-829b89ae801f","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1138","name":"ApplicationShimming","reference":"https://attack.mitre.org/techniques/T1138/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0004","name":"PrivilegeEscalation","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1138","name":"ApplicationShimming","reference":"https://attack.mitre.org/techniques/T1138/"}]}],"type":"query","version":2}
{"description":"Windowscontainsaccessibilityfeaturesthatmaybelaunchedwithakeycombinationbeforeauserhasloggedin.Anadversarycanmodifythewaytheseprogramsarelaunchedtogetacommandpromptorbackdoorwithoutloggingintothesystem.","index":["winlogbeat-*"],"language":"kuery","name":"PotentialModificationofAccessibilityBinaries","query":"event.code:1andprocess.parent.name:winlogon.exeandprocess.name:(atbroker.exeordisplayswitch.exeormagnify.exeornarrator.exeorosk.exeorsethc.exeorutilman.exe)","risk_score":21,"rule_id":"7405ddf1-6c8e-41ce-818f-48bea6bcaed8","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1015","name":"AccessibilityFeatures","reference":"https://attack.mitre.org/techniques/T1015/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0004","name":"PrivilegeEscalation","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1015","name":"AccessibilityFeatures","reference":"https://attack.mitre.org/techniques/T1015/"}]}],"type":"query","version":2}
{"description":"Adversariesmayattempttogetinformationaboutrunningprocessesonasystem.","false_positives":["Administratorsmayusethetasklistcommandtodisplayalistofcurrentlyrunningprocesses.Byitself,itdoesnotindicatemaliciousactivity.Afterobtainingafoothold,it'spossibleadversariesmayusediscoverycommandsliketasklisttogetinformationaboutrunningprocesses."],"index":["winlogbeat-*"],"language":"kuery","name":"ProcessDiscoveryviaTasklist","query":"event.code:1andprocess.name:tasklist.exe","risk_score":21,"rule_id":"cc16f774-59f9-462d-8b98-d27ccd4519ec","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1057","name":"ProcessDiscovery","reference":"https://attack.mitre.org/techniques/T1057/"}]}],"type":"query","version":2}
{"anomaly_threshold":50,"description":"Amachinelearningjobdetectedanunusualusercontextswitch,usingtherunascommandorsimilartechniques,whichcanindicateaccounttakeoverorprivilegeescalationusingcompromisedaccounts.PrivilegeelevationusingtoolslikerunasaremorecommonlyusedbydomainandnetworkadministratorsthanbyregularWindowsusers.","false_positives":["Uncommonuserprivilegeelevationactivitycanbeduetoanadministrator,helpdesktechnician,orauserperformingmanualtroubleshootingorreconfiguration."],"from":"now-45m","interval":"15m","machine_learning_job_id":"windows_rare_user_runas_event","name":"UnusualWindowsUserPrivilegeElevationActivity","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"1781d055-5c66-4adf-9d82-fc0fa58449c8","severity":"low","tags":["Elastic","ML","Windows"],"type":"machine_learning","version":1}
{"anomaly_threshold":50,"description":"Amachinelearningjobdetectedanunusualremotedesktopprotocol(RDP)username,whichcanindicateaccounttakeoverorcredentialedpersistenceusingcompromisedaccounts.RDPattacks,suchasBlueKeep,alsotendtouseunusualusernames.","false_positives":["Uncommonusernameactivitycanbeduetoanengineerloggingontoaserverinstanceinordertoperformmanualtroubleshootingorreconfiguration."],"from":"now-45m","interval":"15m","machine_learning_job_id":"windows_rare_user_type10_remote_login","name":"UnusualWindowsRemoteUser","note":"###InvestigatinganUnusualWindowsUser###\nSignalsfromthisruleindicateactivityforarareandunusualWindowsRDP(remotedesktop)user.Herearesomepossibleavenuesofinvestigation:\n-Considertheuserasidentifiedbytheusernamefield.IstheuserpartofagroupwhonormallylogsintoWindowshostsusingRDP(remotedesktopprotocol)?Isthislogonactivitypartofanexpectedworkflowfortheuser?\n-Considerthesourceofthelogin.Ifthesourceisremote,couldthisberelatedtooccasionaltroubleshootingorsupportactivitybyavendororanemployeeworkingremotely?","references":["https://www.elastic.co/guide/en/siem/guide/current/prebuilt-ml-jobs.html"],"risk_score":21,"rule_id":"1781d055-5c66-4adf-9e93-fc0fa69550c9","severity":"low","tags":["Elastic","ML","Windows"],"type":"machine_learning","version":1}
{"description":"IdentifiesthenativeWindowstoolsregsvr32.exeandregsvr64.exemakinganetworkconnection.ThismaybeindicativeofanattackerbypassingwhitelistingorrunningarbitraryscriptsviaasignedMicrosoftbinary.","false_positives":["Securitytestingmayproduceeventslikethis.Activityofthiskindperformedbynon-engineersandordinaryusersisunusual."],"index":["winlogbeat-*"],"language":"kuery","name":"NetworkConnectionviaRegsvr","query":"process.name:(regsvr32.exeorregsvr64.exe)andevent.action:\"Networkconnectiondetected(rule:NetworkConnect)\"andnotdestination.ip:(10.0.0.0/8or169.254.169.254or172.16.0.0/12or192.168.0.0/16)","risk_score":21,"rule_id":"fb02b8d3-71ee-4af1-bacd-215d23f17efa","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1117","name":"Regsvr32","reference":"https://attack.mitre.org/techniques/T1117/"}]},{"framework":"MITREATT&CK","tactic":{"id":"TA0005","name":"DefenseEvasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1117","name":"Regsvr32","reference":"https://attack.mitre.org/techniques/T1117/"}]}],"type":"query","version":2}
{"description":"IdentifiessuspiciouschildprocessesofPDFreaderapplications.ThesechildprocessesareoftenlaunchedviaexploitationofPDFapplicationsorsocialengineering.","index":["winlogbeat-*"],"language":"kuery","name":"SuspiciousPDFReaderChildProcess","query":"event.action:\"ProcessCreate(rule:ProcessCreate)\"andprocess.parent.name:(AcroRd32.exeorAcrobat.exeorFoxitPhantomPDF.exeorFoxitReader.exe)andprocess.name:(arp.exeordsquery.exeordsget.exeorgpresult.exeorhostname.exeoripconfig.exeornbtstat.exeornet.exeornet1.exeornetsh.exeornetstat.exeornltest.exeorping.exeorqprocess.exeorquser.exeorqwinsta.exeorreg.exeorsc.exeorsysteminfo.exeortasklist.exeortracert.exeorwhoami.exeorbginfo.exeorcdb.exeorcmstp.exeorcsi.exeordnx.exeorfsi.exeorieexec.exeoriexpress.exeorinstallutil.exeorMicrosoft.Workflow.Compiler.exeormsbuild.exeormshta.exeormsxsl.exeorodbcconf.exeorrcsi.exeorregsvr32.exeorxwizard.exeoratbroker.exeorforfiles.exeorschtasks.exeorregasm.exeorregsvcs.exeorcmd.exeorcscript.exeorpowershell.exeorpwsh.exeorwmic.exeorwscript.exeorbitsadmin.exeorcertutil.exeorftp.exe)","risk_score":21,"rule_id":"53a26770-9cbd-40c5-8b57-61d01a325e14","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1204","name":"UserExecution","reference":"https://attack.mitre.org/techniques/T1204/"}]}],"type":"query","version":1}
{"description":"IdentifiesUserAccountControl(UAC)bypassviaeventvwr.exe.AttackersbypassUACtostealthilyexecutecodewithelevatedpermissions.","index":["winlogbeat-*"],"language":"kuery","name":"BypassUACviaEventViewer","query":"process.parent.name:eventvwr.exeandevent.action:\"ProcessCreate(rule:ProcessCreate)\"andnotprocess.executable:(\"C:\\Windows\\SysWOW64\\mmc.exe\"or\"C:\\Windows\\System32\\mmc.exe\")","risk_score":21,"rule_id":"31b4c719-f2b4-41f6-a9bd-fce93c2eaf62","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0004","name":"PrivilegeEscalation","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1088","name":"BypassUserAccountControl","reference":"https://attack.mitre.org/techniques/T1088/"}]}],"type":"query","version":1}
{"description":"Identifiesuseofwhoami.exewhichdisplaysuser,group,andprivilegesinformationfortheuserwhoiscurrentlyloggedontothelocalsystem.","false_positives":["Somenormaluseofthisprogram,atvaryinglevelsoffrequency,mayoriginatefromscripts,automationtoolsandframeworks.Usagebynon-engineersandordinaryusersisunusual."],"index":["winlogbeat-*"],"language":"kuery","name":"WhoamiProcessActivity","query":"process.name:whoami.exeandevent.code:1","risk_score":21,"rule_id":"ef862985-3f13-4262-a686-5f357bbb9bc2","severity":"low","tags":["Elastic","Windows"],"threat":[{"framework":"MITREATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1033","name":"SystemOwner/UserDiscovery","reference":"https://attack.mitre.org/techniques/T1033/"}]}],"type":"query","version":2}
